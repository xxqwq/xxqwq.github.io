<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Node | LX's Blog</title><meta name="author" content="Lx"><meta name="copyright" content="Lx"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Node基础资料：02.初识Node-什么是Node.js哔哩哔哩bilibili 回顾 js的组成：js核心语法+webApi  js为什么能调用DOM、BOM：因为浏览器提供了这些API  浏览器中的js运行环境：V8解析引擎+内置的API   V8引擎负责解析和执行js代码 内置API是由运行环境提供的特殊接口，只能在所属的运行环境中被调用    Nodejs简介 是一个基于Chrome V">
<meta property="og:type" content="article">
<meta property="og:title" content="Node">
<meta property="og:url" content="http://www.coderlx.cn/2023/03/15/Node/index.html">
<meta property="og:site_name" content="LX&#39;s Blog">
<meta property="og:description" content="Node基础资料：02.初识Node-什么是Node.js哔哩哔哩bilibili 回顾 js的组成：js核心语法+webApi  js为什么能调用DOM、BOM：因为浏览器提供了这些API  浏览器中的js运行环境：V8解析引擎+内置的API   V8引擎负责解析和执行js代码 内置API是由运行环境提供的特殊接口，只能在所属的运行环境中被调用    Nodejs简介 是一个基于Chrome V">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.coderlx.cn/img/node.png">
<meta property="article:published_time" content="2023-03-15T13:16:58.000Z">
<meta property="article:modified_time" content="2023-03-15T13:22:15.501Z">
<meta property="article:author" content="Lx">
<meta property="article:tag" content="Node">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.coderlx.cn/img/node.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://www.coderlx.cn/2023/03/15/Node/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"50JQOT66OW","apiKey":"31dd4294fc1929bcfa2f3ee08419e0c3","indexName":"blog","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":500},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Node',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-15 21:22:15'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/lantern.css"><link rel="stylesheet" href="/css/rightMenu.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/index.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/./img/node.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">LX's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Node</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-03-15T13:16:58.000Z" title="发表于 2023-03-15 21:16:58">2023-03-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-15T13:22:15.501Z" title="更新于 2023-03-15 21:22:15">2023-03-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Node/">Node</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Node/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">12.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>44分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Node"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Node基础"><a href="#Node基础" class="headerlink" title="Node基础"></a>Node基础</h1><p>资料：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1a34y167AZ/?p=3&spm_id_from=pageDriver&vd_source=83d30f851f424154f1ee0eeb70a6a728">02.初识Node-什么是Node.js哔哩哔哩bilibili</a></p>
<h2 id="回顾"><a href="#回顾" class="headerlink" title="回顾"></a>回顾</h2><ul>
<li><p>js的组成：js核心语法+webApi</p>
</li>
<li><p>js为什么能调用DOM、BOM：因为浏览器提供了这些API</p>
</li>
<li><p>浏览器中的js运行环境：V8解析引擎+内置的API</p>
</li>
<li><ul>
<li>V8引擎负责解析和执行js代码</li>
<li>内置API是由运行环境提供的特殊接口，只能在所属的运行环境中被调用</li>
</ul>
</li>
</ul>
<h2 id="Nodejs简介"><a href="#Nodejs简介" class="headerlink" title="Nodejs简介"></a>Nodejs简介</h2><ul>
<li><p>是一个基于Chrome <strong>V8引擎</strong>的<strong>JavaScript运行环境</strong></p>
</li>
<li><p>Node.js运行环境：V8引擎+内置API注意：</p>
</li>
<li><ul>
<li>浏览器是js的前端运行环境</li>
<li>node.js是js的后端运行环境</li>
<li>node.js中<strong>无法调用DOM和BOM</strong>等浏览器内置API</li>
</ul>
</li>
</ul>
<h2 id="Node-js可以做什么"><a href="#Node-js可以做什么" class="headerlink" title="Node.js可以做什么"></a>Node.js可以做什么</h2><ul>
<li>基于 <a target="_blank" rel="noopener" href="http://www.expressjs.com.cn/">Express 框架</a>，可以快速构建 Web 应用</li>
<li>基于 <a target="_blank" rel="noopener" href="https://electronjs.org/">Electron 框架</a>，可以构建跨平台的桌面应用</li>
<li>基于 <a target="_blank" rel="noopener" href="http://restify.com/">restify 框架</a>，可以快速构建 API 接口项目</li>
<li>读写和操作数据库、创建实用的命令行工具辅助前端开发、etc…</li>
</ul>
<h2 id="Buffer-缓冲区"><a href="#Buffer-缓冲区" class="headerlink" title="Buffer 缓冲区"></a>Buffer 缓冲区</h2><ul>
<li>Buffer 的结构与数组类似，操作方法与数组类似</li>
<li>数组不能存储二进制文件，Buffer 是专门存储二进制数据的</li>
<li>Buffer 存储的是二进制数据，显示时以 16 进制的形式显示</li>
<li>Buffer 每一个元素范围是 00<del>ff，即 0</del>255、00000000~11111111</li>
<li>每一个元素占用一个字节内存(1byte&#x3D;8bit)</li>
<li>Buffer 是对底<strong>层内存的直接操作</strong>，因此大小一旦确定<strong>就不能修改</strong></li>
</ul>
<p>Buffer 常用方法：</p>
<ul>
<li>Buffer.from(str[, encoding])：将一个字符串转换为 Buffer</li>
<li>Buffer.alloc(size)：创建指定大小的 Buffer</li>
<li>Buffer.alloUnsafe(size)：创建指定大小的 Buffer，可能包含敏感数据（分配内存时不会清除内存残留的数据）</li>
<li>buf.toString()：将 Buffer 数据转为字符串</li>
</ul>
<h2 id="内置API模块"><a href="#内置API模块" class="headerlink" title="内置API模块"></a>内置API模块</h2><h3 id="fs文件系统模块"><a href="#fs文件系统模块" class="headerlink" title="fs文件系统模块"></a>fs文件系统模块</h3><h4 id="读取文件内容"><a href="#读取文件内容" class="headerlink" title="读取文件内容"></a>读取文件内容</h4><ul>
<li><p>fs模块是官方提供的用来操作we年的模块</p>
</li>
<li><p>fs.readFile() 方法用来读取指定文件中的内容</p>
</li>
<li><p>fs.writeFile() 方法用来写入内容</p>
</li>
<li><ul>
<li>需要先导入模块 ：const fs &#x3D; require(‘fs’)</li>
</ul>
</li>
</ul>
<h5 id="fs-readFile"><a href="#fs-readFile" class="headerlink" title="fs.readFile()"></a>fs.readFile()</h5><ul>
<li>语法格式：fs.readFile(path[,options],callback)</li>
<li>参数1：必选参数，表示文件的路径</li>
<li>参数2：可选参数，表示以什么编码格式来读取（一般指定utf-8)</li>
<li>参数3：必选参数，文件读取完成后通过回调函数拿到读取的结果（err,datastr)，如果读取成功，则err的值为null;如果读取失败，则err的值为错误对象，datastr的值为undefined</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const fs = require(&#x27;fs&#x27;)//导入fs模块</span><br><span class="line"></span><br><span class="line">fs.readFile(&#x27;../files/1.txt&#x27;, &#x27;utf-8&#x27;, (err,datastr) =&gt; &#123;</span><br><span class="line">  console.log(&quot;err:&quot;, err)</span><br><span class="line">  console.log(&quot;success:&quot;,datastr)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="fs-writeFile"><a href="#fs-writeFile" class="headerlink" title="fs.writeFile()"></a>fs.writeFile()</h5><ul>
<li><p>语法格式：fs.writeFile(file,data[,options],callback)</p>
</li>
<li><p>参数1：必选参数，表示文件的路径</p>
</li>
<li><p>参数2：必选参数，表示要写入的内容</p>
</li>
<li><p>参数3：可选参数，表示以什么格式写入文件内容，默认值是utf8</p>
</li>
<li><p>参数4：必选参数，文件写入完成后的回调函数</p>
</li>
<li><ul>
<li>如果文件写入成功，则err的值等于null</li>
<li>如果文件写入失败，则err的值等于一个错误对象</li>
</ul>
</li>
<li><p>注意：这个api不能用来创建文件</p>
</li>
<li><p>注意：这个api写入文件是覆盖的写入</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const fs = require(&#x27;fs&#x27;)</span><br><span class="line">fs.writeFile(&#x27;../files/write.txt&#x27;, &#x27;abcd&#x27;, &#x27;utf-8&#x27;, (err) =&gt; &#123;</span><br><span class="line">  if (!err) &#123;</span><br><span class="line">    fs.readFile(&#x27;../files/write.txt&#x27;, &#x27;utf-8&#x27;, (err, dataStr) =&gt; &#123;</span><br><span class="line">      console.log(dataStr)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h6 id="案例：考试成绩管理"><a href="#案例：考试成绩管理" class="headerlink" title="案例：考试成绩管理"></a>案例：考试成绩管理</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">const fs = require(&#x27;fs&#x27;)</span><br><span class="line"></span><br><span class="line">fs.readFile(&#x27;../files/成绩.txt&#x27;, &#x27;utf-8&#x27;, (err, dataStr) =&gt; &#123;</span><br><span class="line">  if (!err) &#123;</span><br><span class="line">    const data = dataStr.split(&#x27; &#x27;)</span><br><span class="line">    const arrNew = []</span><br><span class="line">    data.forEach(item =&gt; &#123;</span><br><span class="line">      arrNew.push(item.replace(&#x27;=&#x27;, &#x27;:&#x27;))</span><br><span class="line">    &#125;)</span><br><span class="line">    const newstr = arrNew.join(&#x27;\r\n&#x27;)//处理数据</span><br><span class="line">    fs.writeFile(&#x27;../files/成绩-ok.txt&#x27;, newstr, &#x27;utf-8&#x27;, (err) =&gt; &#123;</span><br><span class="line">      if (err) &#123;</span><br><span class="line">        console.log(&quot;写入失败&quot; + err)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    console.log(&#x27;读取文件失败！&#x27;, err)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="路径动态拼接的问题"><a href="#路径动态拼接的问题" class="headerlink" title="路径动态拼接的问题"></a>路径动态拼接的问题</h5><ul>
<li>在使用fs模块操作文件时，如果提供的操作路径是相对路径是很容易出现路径错误的问题，因为node在执行的时候是以执行node命令的目录为基准的。</li>
<li>解决：给一个完整的路径</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">const fs = require(&#x27;fs&#x27;)</span><br><span class="line"></span><br><span class="line">fs.readFile(&#x27;./files/1.txt&#x27;, &#x27;utf8&#x27;, (err, datastr) =&gt; &#123;</span><br><span class="line">  if (err) &#123;</span><br><span class="line">    console.log(&quot;err:&quot;+err)</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    console.log(datastr)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)//错误</span><br><span class="line">fs.readFile(&#x27;D:/桌面/Node.js/files/1.txt&#x27;, &#x27;UTF8&#x27;, (err, datastr) =&gt; &#123;</span><br><span class="line">  if (err) &#123;</span><br><span class="line">    console.log(&quot;err:&quot;,err)</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    console.log(datastr)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)//移植性很差</span><br><span class="line">fs.readFile(__dirname+&#x27;/../files/1.txt&#x27;, &#x27;utf8&#x27;, (err, datastr) =&gt; &#123;</span><br><span class="line">  if (err) &#123;</span><br><span class="line">    console.log(&quot;err:&quot;, err)</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    console.log(datastr)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>__dirname表示当前文件所在目录</li>
</ul>
<h3 id="path模块"><a href="#path模块" class="headerlink" title="path模块"></a>path模块</h3><h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><ul>
<li><p>path模块是Node.js官方提供的用来处理路径的模块</p>
</li>
<li><p>常见方法：</p>
</li>
<li><ul>
<li>path.join():拼接路径</li>
<li>path.basename()：用来从路径字符串中将文件名解析出来</li>
</ul>
</li>
</ul>
<h5 id="path-join"><a href="#path-join" class="headerlink" title="path.join()"></a>path.join()</h5><ul>
<li>语法格式：path.join([…paths])</li>
<li>拼接路径都要使用path.join()，不要使用加号了</li>
<li>注意：’..&#x2F;‘会抵消前面的路径</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&#x27;path&#x27;)</span><br><span class="line">const pathstr = path.join(__dirname, &quot;/../files/1.txt&quot;)</span><br><span class="line">console.log(pathstr)</span><br></pre></td></tr></table></figure>

<h5 id="path-basename"><a href="#path-basename" class="headerlink" title="path.basename()"></a>path.basename()</h5><ul>
<li>用来获取路径的最后一个文件名</li>
<li>语法格式：path.basename(path,[…etx])</li>
<li>参数一：必选参数，表示路径的字符串</li>
<li>参数二：可选参数，表示文件的扩展名（用了之后就返回删除了扩展名的路径)</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&#x27;path&#x27;)</span><br><span class="line">const pathstr=&quot;./1/2/3.html&quot;</span><br><span class="line">const res=path.basename(pathstr,&#x27;.html&#x27;)</span><br><span class="line">console.log(res)//3</span><br></pre></td></tr></table></figure>

<h5 id="path-extname"><a href="#path-extname" class="headerlink" title="path.extname()"></a>path.extname()</h5><ul>
<li>用来获取路径的扩展名</li>
<li>语法格式：path.basename(path,[…etx])</li>
<li>参数一：必选参数，表示路径的字符串</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const path=require(&#x27;path&#x27;)</span><br><span class="line">const pathstr=&#x27;./1/2/321.txt&#x27;</span><br><span class="line">const str=path.extname(pathstr)</span><br><span class="line">console.log(str)//.txt</span><br></pre></td></tr></table></figure>

<h3 id="http模块"><a href="#http模块" class="headerlink" title="http模块"></a>http模块</h3><ul>
<li>简介：是Nodejs官方提供的web服务器的模块，通过http.createServer()方法，就能方便的把一台普通的电脑变成一台web服务器，从而对外提供web资源服务</li>
<li>进一步理解：服务器与普通电脑的区别就在于服务器安装了web服务器软件，nodejs可以手写一个服务器</li>
</ul>
<h4 id="服务器相关的概念："><a href="#服务器相关的概念：" class="headerlink" title="服务器相关的概念："></a>服务器相关的概念：</h4><ul>
<li><p><strong>IP地址</strong>：是互联网上每台计算机的唯一地址，因此IP地址具有唯一性。</p>
</li>
<li><ul>
<li>通常用点分十进制表示成a.b.c.d，a,b,c,d都是0-255之间的十进制整数</li>
<li>互联网中每台web服务器都有自己的ip地址，可以运行 ping <a target="_blank" rel="noopener" href="http://www.baidu.com查询/">www.baidu.com查询</a></li>
<li>开发期间，自己的电脑既是一台服务器，也是一个客户端，在自己的浏览器中输入127.0.0.1这个IP地址，就能把自己的电脑当作一台服务器进行访问了</li>
</ul>
</li>
<li><p><strong>域名</strong>：字符型的地址方案（IP的别名)，IP和域名是一一对应的关系</p>
</li>
<li><ul>
<li>注意：单纯使用ip地址互联网中的电脑也能正常工作，但是有了域名更方便</li>
<li>开发中127.0.0.1对应的域名是localhost</li>
<li>一个ip可以对应多个域名，但是一个域名只能对应一个ip</li>
</ul>
</li>
<li><p><strong>域名服务器</strong>：负责提供域名和IP转换的服务的服务器。</p>
</li>
<li><p><strong>端口号</strong>：表示web服务，客户端发送的网络请求，通过端口号，可以被准确的交给对应的web服务进行处理。</p>
</li>
<li><p><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1677908256206-4e62e072-752c-49d1-861e-f98e921e960d.png" alt="img"></p>
</li>
<li><ul>
<li><strong>每个端口号不能同时被多个web服务占用</strong></li>
<li><strong>URL中的80端口可以被省略</strong></li>
</ul>
</li>
</ul>
<h4 id="创建web服务器"><a href="#创建web服务器" class="headerlink" title="创建web服务器"></a>创建web服务器</h4><h5 id="导入http模块"><a href="#导入http模块" class="headerlink" title="导入http模块"></a>导入http模块</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const http=require(&#x27;http&#x27;)</span><br></pre></td></tr></table></figure>

<h5 id="创建web服务器实例"><a href="#创建web服务器实例" class="headerlink" title="创建web服务器实例"></a>创建web服务器实例</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const server=http.createServer()</span><br></pre></td></tr></table></figure>

<h5 id="为服务器实例绑定request事件，监听客户端的请求"><a href="#为服务器实例绑定request事件，监听客户端的请求" class="headerlink" title="为服务器实例绑定request事件，监听客户端的请求"></a>为服务器实例绑定request事件，监听客户端的请求</h5><ul>
<li><p>只要有客户端请求自己的服务器，就会触发request事件，从而调用这个事件处理函数</p>
</li>
<li><p><strong>req</strong>:如果在事件处理函数中访问与客户端相关的属性或书记可以使用以下的方法</p>
</li>
<li><ul>
<li>req.url:是客户端请求的url地址</li>
<li>req.methods是客户端的method请求类型</li>
<li><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1677909570953-8ba4e5df-5777-4f2b-9df6-8ef1d543c1ca.png" alt="img"></li>
<li>可以用postman测试post请求</li>
</ul>
</li>
<li><p><strong>res</strong>:响应对象，如果在事件处理函数中访问与服务器相关的数据或属性，可以使用以下的方式</p>
</li>
<li><ul>
<li>res.end（）：向客户端发送指定的内容，并结束这次请求的处理过程</li>
<li>为了防止中文乱码的为题，需要设置响应头Content-Type的值为text&#x2F;html；charset&#x3D;utf-8</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&quot;Content-Type&quot;</span>,<span class="string">&quot;text/html; charset=utf-8&quot;</span>)</span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&#x27;request&#x27;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;<span class="comment">//使用服务器实例的on方法绑定一个request时间</span></span><br><span class="line">    <span class="comment">//只要有客户端请求自己的服务器，就会触发request事件，从而调用这个事件处理函数</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;有请求&quot;</span>)</span><br><span class="line">    <span class="keyword">const</span> method=req.<span class="property">method</span></span><br><span class="line">    <span class="keyword">const</span> url=req.<span class="property">url</span></span><br><span class="line">    <span class="keyword">const</span> str=<span class="string">`Your request url is <span class="subst">$&#123;url&#125;</span>,and request method is <span class="subst">$&#123;method&#125;</span>`</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(str)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="启动服务器"><a href="#启动服务器" class="headerlink" title="启动服务器"></a>启动服务器</h5><ul>
<li>调用server.listen(端口号,cb回调)方法，即可启动web服务器</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server.<span class="title function_">listen</span>(<span class="number">8</span>,<span class="function">()=&gt;</span>&#123;<span class="comment">//调用server.listen(端口号,cb回调)方法，即可启动web服务器</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;服务器开启&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="根据不同的url响应不同的html内容"><a href="#根据不同的url响应不同的html内容" class="headerlink" title="根据不同的url响应不同的html内容"></a>根据不同的url响应不同的html内容</h4><ul>
<li>获取请求的url地址</li>
<li>设置默认的相应内容 404 Not found</li>
<li>判断用户请求的是否为&#x2F;或者&#x2F;index.html</li>
<li>判断用户请求的是否为&#x2F;about.html</li>
<li>设置Content-Type响应头，防止中文乱码</li>
<li>使用res.end()把内容响应给客户端</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>()</span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&#x27;request&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//1.获取请求的url地址</span></span><br><span class="line">    <span class="keyword">const</span> url = req.<span class="property">url</span></span><br><span class="line">    <span class="comment">//2. 设置默认的404页面</span></span><br><span class="line">    <span class="keyword">let</span> content = <span class="string">&#x27;&lt;h1&gt; 404 Not Found &lt;/h1&gt;&#x27;</span></span><br><span class="line">    <span class="comment">//3.判断请求的url</span></span><br><span class="line">    <span class="keyword">if</span> (url === <span class="string">&quot;/&quot;</span> || url === <span class="string">&quot;/index.html&quot;</span>) &#123;</span><br><span class="line">        content = <span class="string">&#x27;&lt;h1&gt;首页&lt;/h1&gt;&#x27;</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (url === <span class="string">&quot;/about.html&quot;</span>) &#123;</span><br><span class="line">        content = <span class="string">&#x27;&lt;h1&gt;关于&lt;/h1&gt;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//4.设置响应头</span></span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;text/html; charset=utf-8&quot;</span>)</span><br><span class="line">    <span class="comment">//5.响应给客户端</span></span><br><span class="line">    res.<span class="title function_">end</span>(content)</span><br><span class="line">&#125;)</span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;服务器开启&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="例子：时钟web服务器案例"><a href="#例子：时钟web服务器案例" class="headerlink" title="例子：时钟web服务器案例"></a>例子：时钟web服务器案例</h5><ul>
<li>核心思路：把文件的实际存放路径作为每个资源的请求url地址</li>
<li><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1677911360906-56b8d811-884d-4f0e-b74c-188dfde21b66.png" alt="img"></li>
<li>导入需要的模块</li>
<li>创建web服务器</li>
<li>将资源的请求url地址映射为文件的存放路径</li>
<li>读取文件内容并响应给客户端</li>
<li>优化资源的请求路径</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//导入需要的模块</span></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>)</span><br><span class="line"><span class="comment">//开启web服务器</span></span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>()</span><br><span class="line">server.<span class="title function_">on</span>(<span class="string">&quot;request&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//将资源的请求url地址映射为文件的存放地址</span></span><br><span class="line">    <span class="keyword">const</span> url = req.<span class="property">url</span></span><br><span class="line">    <span class="comment">// const fpath = path.join(__dirname, url)</span></span><br><span class="line">    <span class="comment">//优化路径</span></span><br><span class="line">    <span class="keyword">let</span> fpath = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> (url === <span class="string">&quot;/&quot;</span>) &#123;</span><br><span class="line">        fpath = path.<span class="title function_">join</span>(__dirname, <span class="string">&quot;./clock/index.html&quot;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        fpath = path.<span class="title function_">join</span>(__dirname, <span class="string">&quot;/clock&quot;</span>, url)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//读取文件内容并响应给客户端</span></span><br><span class="line">    fs.<span class="title function_">readFile</span>(fpath, <span class="string">&quot;utf8&quot;</span>, <span class="function">(<span class="params">err, dataStr</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="comment">//读取失败，向客户端响应固定的错误消息</span></span><br><span class="line">            res.<span class="title function_">end</span>(<span class="string">&quot;404 Not Found&quot;</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;读取失败&quot;</span> + err.<span class="property">message</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.<span class="title function_">end</span>(dataStr)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;服务器开启&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h3><h4 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h4><ul>
<li><p>模块化是指解决一个复杂问题时，自顶向下逐层把系统划分为若干模块的过程，对于整个系统来说，模块是可组合、分解和更换的单元。</p>
</li>
<li><p>编程领域中就是遵守固定的规则，把一个大文件拆成独立并互相依赖的多个小模块</p>
</li>
<li><p>优点：</p>
</li>
<li><ul>
<li>提高了代码的复用性</li>
<li>提高了代码的可维护性</li>
<li>可以实现按需加载</li>
</ul>
</li>
</ul>
<h4 id="模块化规范"><a href="#模块化规范" class="headerlink" title="模块化规范"></a>模块化规范</h4><ul>
<li><p>优点：大家都遵守同样的模块化规范写代码，降低沟通成本，方便了各个模块之间的相互调用</p>
</li>
<li><ul>
<li>在每个模块内部，module变量代表当前模块</li>
<li>module变量是一个对象，他的exports属性是对外的接口</li>
<li>加载某个模块，其实是加载该模块的module.exports属性，require方法用于加载模块</li>
</ul>
</li>
</ul>
<h4 id="Node中的模块化"><a href="#Node中的模块化" class="headerlink" title="Node中的模块化"></a>Node中的模块化</h4><h5 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h5><ul>
<li>内置模块：node官方提供的，例如fs、path</li>
<li>自定义模块：用户创建的每个.js文件</li>
<li>第三方模块：第三方开发出来的模块，使用前需要先下载</li>
</ul>
<h5 id="加载模块"><a href="#加载模块" class="headerlink" title="加载模块"></a>加载模块</h5><ul>
<li>使用require（）方法加载模块</li>
<li><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1677915104952-0ea5a983-5ff0-4eb3-aec3-e4243d6a7e77.png" alt="img"></li>
<li>注意：通过require加载模块时，会执行里面的代码</li>
<li>注意：加载自定义模块不一定要提供后缀名</li>
</ul>
<h5 id="模块作用域"><a href="#模块作用域" class="headerlink" title="模块作用域"></a>模块作用域</h5><ul>
<li><p>定义：和函数作用域类似，在自定义模块中定义的变量、方法等成员，只能在当前模块内被访问，这种模块级别的访问限制，叫做作用域</p>
</li>
<li><p>优点：防止全局变量污染</p>
</li>
<li><p>遵循了commonjs规范，规定了模块的特性与各模块之间如何相互依赖</p>
</li>
<li><ul>
<li>在每个模块内部，module变量代表当前模块</li>
<li>module变量是一个对象，他的exports属性是对外的接口</li>
<li>加载某个模块，其实是加载该模块的module.exports属性，require方法用于加载模块</li>
</ul>
</li>
</ul>
<h5 id="module对象"><a href="#module对象" class="headerlink" title="module对象"></a>module对象</h5><ul>
<li>作用：每个js自定义模块中都有一个module对象，它里面存储了和当前模块有关的信息</li>
</ul>
<h6 id="module-exports对象"><a href="#module-exports对象" class="headerlink" title="module.exports对象"></a>module.exports对象</h6><ul>
<li>默认等于一个空对象</li>
<li>在自定义模块中可以使用这个对象姜模块内的成员共享出去，供外界使用</li>
<li>在外界使用require导入一个自定义模块的时候，得到的成员就是那个模块中，通过module。exports所指向的对象</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;加载test模块&quot;</span>)</span><br><span class="line"><span class="comment">// console.log(module)</span></span><br><span class="line"><span class="keyword">const</span> username = <span class="string">&quot;张三&quot;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sayhello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;大家好，我是&quot;</span> + username)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">sayhello</span>()</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>=&#123;</span><br><span class="line">    <span class="number">1</span>:<span class="number">1</span>,</span><br><span class="line">    <span class="number">2</span>:<span class="string">&quot;hh&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>.<span class="property">username</span>=username</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>.<span class="property">sayhello</span>=sayhello</span><br><span class="line"><span class="comment">//&#123; &#x27;1&#x27;: 1, &#x27;2&#x27;: &#x27;hh&#x27;, username: &#x27;张三&#x27;, sayhello: [Function: sayhello] &#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>注意：使用require方法导入模块时，导入的结果，永远以module.exports指向的对象为准</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;加载test模块&quot;</span>)</span><br><span class="line"><span class="comment">// console.log(module)</span></span><br><span class="line"><span class="keyword">const</span> username = <span class="string">&quot;张三&quot;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sayhello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;大家好，我是&quot;</span> + username)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">sayhello</span>()</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>.<span class="property">username</span>=username</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>.<span class="property">sayhello</span>=sayhello</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>=&#123;</span><br><span class="line">    <span class="number">1</span>:<span class="number">1</span>,</span><br><span class="line">    <span class="number">2</span>:<span class="string">&quot;hh&quot;</span></span><br><span class="line">&#125;<span class="comment">//&#123; &#x27;1&#x27;: 1, &#x27;2&#x27;: &#x27;hh&#x27; &#125;</span></span><br></pre></td></tr></table></figure>

<h5 id="exports对象"><a href="#exports对象" class="headerlink" title="exports对象"></a>exports对象</h5><ul>
<li>由于module.exports写起来比较复杂，因此提供了一个exports对象，写的时候还是以module.exports指向为准</li>
<li>注意：只是一开始是相等的，如果修改了指向就不一定了</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">exports</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">module</span>.<span class="property">exports</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">exports</span>===<span class="variable language_">module</span>.<span class="property">exports</span>)<span class="comment">//true</span></span><br><span class="line"><span class="built_in">exports</span>=&#123;&#125;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>=&#123;<span class="number">1</span>:<span class="number">1</span>,<span class="number">2</span>:<span class="number">3</span>&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">exports</span>===<span class="variable language_">module</span>.<span class="property">exports</span>)<span class="comment">//false</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>exports和module.exports的使用误区</p>
</li>
<li><ul>
<li>require（）时得到的永远是module.exports指向的对象</li>
<li>如果不改变exports的指向，那么它修改的结果可以作用域module.exports</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exports</span> 对象是 <span class="variable language_">module</span> 对象的一个属性,在初始时 <span class="variable language_">module</span>.<span class="property">exports</span> 和 <span class="built_in">exports</span> 指向同一块内存区域</span><br><span class="line">模块导出的是 <span class="variable language_">module</span>.<span class="property">exports</span> , <span class="built_in">exports</span> 只是对它的引用,在不改变<span class="built_in">exports</span> 内存的情况下,修改<span class="built_in">exports</span> 的值可以改变 <span class="variable language_">module</span>.<span class="property">exports</span> 的值</span><br><span class="line">导出时尽量使用 <span class="variable language_">module</span>.<span class="property">exports</span> ,以免因为各种赋值导致的混乱</span><br><span class="line">作者：闪现A小兵</span><br><span class="line">来源：稀土掘金</span><br></pre></td></tr></table></figure>

<h5 id="包与npm"><a href="#包与npm" class="headerlink" title="包与npm"></a>包与npm</h5><h6 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h6><ul>
<li>定义：Node.js的<strong>第三方模块</strong>又叫做包</li>
<li>来源：包是由第三方个人或团队开发出来的，免费供所有人使用</li>
<li>为什么需要：Node.js的内置模块仅提供了一些底层的API,导致在基于内置模块开发时，效率很低。包时基于内置模块封装出来的，提供了更高级、更方便的API，极大的提高了开发效率。</li>
<li>搜索：从<a target="_blank" rel="noopener" href="https://www.npmjs.com/">npm</a> 搜索需要的包</li>
<li>下载：通过包管理工具 Node Package Manager （包管理工具)从<a target="_blank" rel="noopener" href="https://registry.npmjs.org/">链接</a></li>
</ul>
<h6 id="例子：格式化时间的两种方法"><a href="#例子：格式化时间的两种方法" class="headerlink" title="例子：格式化时间的两种方法"></a>例子：格式化时间的两种方法</h6><ul>
<li>传统方法:<img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1677996863808-0da15194-144a-4f85-8eb6-cefa2c6d7865.png" alt="img"></li>
<li>高级做法：导入第三方包moment</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> moment = <span class="built_in">require</span>(<span class="string">&#x27;moment&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> dt1 = <span class="title function_">moment</span>().<span class="title function_">format</span>(<span class="string">&quot;YYYY-MM-DD HH:mm:ss&quot;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dt1)</span><br></pre></td></tr></table></figure>

<h6 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h6><ul>
<li><p>文件结构：</p>
</li>
<li><ul>
<li>node_modules文件夹用来存放所有安装到项目中的包</li>
<li>package-lock.json用来记录node_modules目录下的每一个包的下载信息</li>
<li>package.json主要用来定义项目中需要依赖的包</li>
</ul>
</li>
<li><p>安装指定版本的包:@</p>
</li>
<li><p>包的语义化版本规范：点分十进制，例如2.24.0</p>
</li>
<li><ul>
<li>第一位数字：大版本</li>
<li>第二位数字：功能版本（大版本没更新，但是更新了一些功能)</li>
<li>第三位数字：bug修复版本</li>
<li>提升的规则：<strong>只要前面的版本号增长了，则后面的版本号归零</strong></li>
</ul>
</li>
</ul>
<h6 id="包管理配置文件"><a href="#包管理配置文件" class="headerlink" title="包管理配置文件"></a>包管理配置文件</h6><ul>
<li>在项目根目录，必须提供一个叫做package.json的包管理配置文件，用来记录和项目有关的一些配置信息，例如项目的名称、版本号、描述、那些包在开发时用到等等</li>
<li>多人协作共享时，会遇到node_modules过大的问题，可以用package.json的配置文件记录项目中安装了哪些包，可以供团队成员共享。</li>
<li>注意：开发中要把node_moduls文件夹添加到.gitignore忽略文件中</li>
<li>快速创建:</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure>

<ul>
<li><ul>
<li>注意：只能在英文的目录下成功运行，运行时会自动把包的名称和版本号记录到package.json中</li>
</ul>
</li>
<li><p><strong>dependencies</strong>：记录安装了哪些包</p>
</li>
<li><ul>
<li>当执行npm i命令时，会先读取package.json的dependencies节点</li>
</ul>
</li>
<li><p><strong>devDependencies</strong>:记录某些包在项目开发阶段用到，上线之后不会用到</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i 包名 -D<span class="comment">//简写</span></span><br><span class="line">npm install 包名 --save-dev<span class="comment">//完整写法,--save-dev放在包名前面或者后面都可以</span></span><br></pre></td></tr></table></figure>

<h6 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm uninstall moment</span><br></pre></td></tr></table></figure>

<ul>
<li>运行后会自动把包从package.json的dependencies节点中删除</li>
</ul>
<h6 id="切换镜像源"><a href="#切换镜像源" class="headerlink" title="切换镜像源"></a>切换镜像源</h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm i nrm -g</span><br><span class="line">nrm ls<span class="comment">//查看所有可用镜像源</span></span><br><span class="line">nrm use taobao<span class="comment">//切换淘宝镜像</span></span><br></pre></td></tr></table></figure>

<h6 id="包的分类"><a href="#包的分类" class="headerlink" title="包的分类"></a>包的分类</h6><ul>
<li><p>开发依赖包:-D</p>
</li>
<li><p>核心依赖包</p>
</li>
<li><p>全局包:-g</p>
</li>
<li><ul>
<li>只有工具性质的包，才有全局安装的必要性<img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678000548161-1d3ce4f8-888e-4ead-ab38-c58cdb7f2186.png" alt="img"></li>
<li>例：<strong>i5ting_toc：可以把md文档转成html</strong></li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i i5ting_toc -g</span><br><span class="line">i5ting_tociting_toc-f 要转换的md文件路径 -<span class="title function_">o</span>(自动打开)</span><br></pre></td></tr></table></figure>

<h6 id="规范的包结构"><a href="#规范的包结构" class="headerlink" title="规范的包结构"></a>规范的包结构</h6><ul>
<li>包必须以单独的目录存在</li>
<li>包的顶级目录下必须包含package.json这个配置文件</li>
<li>package.json必须包含name,version,main这三个属性，分别代表名字，版本号，入口</li>
</ul>
<h6 id="开发一个自己的包"><a href="#开发一个自己的包" class="headerlink" title="开发一个自己的包"></a>开发一个自己的包</h6><ul>
<li><p>实现的功能：</p>
</li>
<li><ul>
<li>格式化时间</li>
<li>转义html中的特殊字符</li>
<li>还原html中的特殊字符</li>
</ul>
</li>
<li><p>初始化包的基本结构</p>
</li>
<li><ul>
<li>新建itheima-tools作为根目录</li>
<li>新建package.json、index.js、README.md</li>
</ul>
</li>
<li><p>初始化package.json</p>
</li>
<li><ul>
<li>name:包的名称</li>
<li>version:版本号</li>
<li>main:入口文件</li>
<li>description:描述</li>
<li>keyword:关键字</li>
<li>license:协议</li>
</ul>
</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;date-html_tools&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;进行时间格式化以及html的转义与还原的小工具&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;keywords&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;dateFormat&quot;</span><span class="punctuation">,</span><span class="string">&quot;htmlEscape&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ISC&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>模块化拆分</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678002642482-cb34512f-b25b-482a-9b55-c8f46d4c4fd4.png" alt="img"></p>
<ul>
<li>编写说明文档</li>
<li>发布包</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm publish</span><br></pre></td></tr></table></figure>

<ul>
<li><ul>
<li>注意：发布的时候必须切换回npm的服务器</li>
</ul>
</li>
<li><p>删除包</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm unpublish 包名 --force</span><br></pre></td></tr></table></figure>

<ul>
<li><ul>
<li>注意:npm unpublish命令只能删除72h以内的包</li>
<li>npm unpublish删除的包，24h内不能重复发布</li>
<li>最好不要发布没有意义的包</li>
</ul>
</li>
</ul>
<h5 id="模块的加载机制"><a href="#模块的加载机制" class="headerlink" title="模块的加载机制"></a>模块的加载机制</h5><h6 id="优先从缓存中加载"><a href="#优先从缓存中加载" class="headerlink" title="优先从缓存中加载"></a>优先从缓存中加载</h6><ul>
<li>模块在第一次加载后会被缓存，因此多次调用require不会导致模块的代码被执行多次，提高了效率</li>
</ul>
<h6 id="内置模块加载优先级最高"><a href="#内置模块加载优先级最高" class="headerlink" title="内置模块加载优先级最高"></a>内置模块加载优先级最高</h6><h6 id="加载自定义模块，必须指定-x2F-或-x2F-开头的路径标识符，否则会当成内置模块或者第三方模块加载"><a href="#加载自定义模块，必须指定-x2F-或-x2F-开头的路径标识符，否则会当成内置模块或者第三方模块加载" class="headerlink" title="加载自定义模块，必须指定.&#x2F;或.&#x2F;开头的路径标识符，否则会当成内置模块或者第三方模块加载"></a>加载自定义模块，必须指定.&#x2F;或.&#x2F;开头的路径标识符，否则会当成内置模块或者第三方模块加载</h6><ul>
<li><p>在导入自定义模块时，如果忽略的扩展名，则会按顺序分别尝试加载</p>
</li>
<li><ul>
<li>按照确切的文件名进行加载</li>
<li>补全.js扩展名进行加载</li>
<li>补全.json扩展名进行加载</li>
<li>补全.node扩展名进行加载</li>
<li>加载错误，报错</li>
</ul>
</li>
</ul>
<h6 id="加载第三方模块"><a href="#加载第三方模块" class="headerlink" title="加载第三方模块"></a>加载第三方模块</h6><ul>
<li>如果传递的模块标识符不是一个内置模块，也没有以’.&#x2F;‘或’..&#x2F;开头，则node会从当前模块的父目录开始，尝试从&#x2F;node_modules文件夹加载第三方模块</li>
<li>如果没有找到，那么会移动到上一层父目录进行加载，直到根目录</li>
</ul>
<h6 id="目录作为模块"><a href="#目录作为模块" class="headerlink" title="目录作为模块"></a>目录作为模块</h6><ul>
<li><p>当把目录作为模块标识符，传递给require时有三种加载方式</p>
</li>
<li><ul>
<li>在被加载的目录下查找package.json文件并寻找main属性作为入口</li>
<li>如果没有package.json或者main不存在，则node会试图加载目录下的index.js文件</li>
<li>如果以上都失败了，就会打印错误消息</li>
</ul>
</li>
</ul>
<h1 id="Express"><a href="#Express" class="headerlink" title="Express"></a>Express</h1><h2 id="初识express"><a href="#初识express" class="headerlink" title="初识express"></a>初识express</h2><h3 id="简介-2"><a href="#简介-2" class="headerlink" title="简介"></a>简介</h3><ul>
<li><p>官方:express是基于Node.js平台，快速、开放、极简的WEB开发框架</p>
</li>
<li><p>通俗的理解：Express的作用和http模块类似，是用来创建web服务器的</p>
</li>
<li><p>本质：本质上就是一个npm的第三方包，提供了快速创建web服务器的便捷方法，是基于http模块进一步封装出来的</p>
</li>
<li><p>作用：</p>
</li>
<li><ul>
<li>Web网站服务器：专门对外提供web网页资源的服务器</li>
<li>API接口服务器：专门对外提供API接口的服务器</li>
</ul>
</li>
</ul>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i express</span><br></pre></td></tr></table></figure>

<h3 id="创建基本的Web服务器"><a href="#创建基本的Web服务器" class="headerlink" title="创建基本的Web服务器"></a>创建基本的Web服务器</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//导入express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="comment">//创建web服务器</span></span><br><span class="line"><span class="keyword">const</span> app=<span class="title function_">express</span>()<span class="comment">//返回服务器实例</span></span><br><span class="line"><span class="comment">//启动服务器</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server is running&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="监听GET请求和Post请求"><a href="#监听GET请求和Post请求" class="headerlink" title="监听GET请求和Post请求"></a>监听GET请求和Post请求</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;请求URL&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>参数一：请求的URL地址</p>
</li>
<li><p>参数二：请求对应的处理函数</p>
</li>
<li><ul>
<li>req:请求对象，包含了与请求相关的属性和方法</li>
<li>res:响应对象，包含了与相应相关的属性与方法</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;请求URL&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>参数一：请求的URL地址</p>
</li>
<li><p>参数二：请求对应的处理函数</p>
</li>
<li><ul>
<li>req:请求对象，包含了与请求相关的属性和方法</li>
<li>res:响应对象，包含了与相应相关的属性与方法</li>
</ul>
</li>
</ul>
<h4 id="把内容响应给客户端"><a href="#把内容响应给客户端" class="headerlink" title="把内容响应给客户端"></a>把内容响应给客户端</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.<span class="title function_">send</span>()</span><br></pre></td></tr></table></figure>

<h4 id="获取URL中携带的查询参数"><a href="#获取URL中携带的查询参数" class="headerlink" title="获取URL中携带的查询参数"></a>获取URL中携带的查询参数</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">query</span>)</span><br><span class="line">    res.<span class="title function_">send</span>(req.<span class="property">query</span>)<span class="comment">//获取客户端发送过来的查询参数</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>默认是一个空对象</li>
</ul>
<h4 id="获取URL中携带的动态参数"><a href="#获取URL中携带的动态参数" class="headerlink" title="获取URL中携带的动态参数"></a>获取URL中携带的动态参数</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/user/:id&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">params</span>)</span><br><span class="line">    res.<span class="title function_">send</span>(req.<span class="property">params</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>默认是一个空对象，里面存放着通过 ：动态匹配到的参数值</li>
</ul>
<h3 id="托管静态资源"><a href="#托管静态资源" class="headerlink" title="托管静态资源"></a>托管静态资源</h3><h4 id="express-static"><a href="#express-static" class="headerlink" title="express.static()"></a>express.static()</h4><ul>
<li>方便的创建一个静态资源服务器</li>
<li>express在指定的静态目录中查找文件，并对外提供资源的访问路径，<strong>因此存放静态文件的目录名不会出现在URL中</strong></li>
<li><strong>托管多个静态资源目录，只需要多次调用</strong></li>
<li><strong>访问时，express.static()函数会根据目录的添加顺序查找所需的文件</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&quot;../../clock&quot;</span>))</span><br></pre></td></tr></table></figure>

<ul>
<li>如果希望在托管的静态资源访问路径之前，挂在路径前缀，可以在第一个参数写</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;public&#x27;</span>，express.<span class="title function_">static</span>(<span class="string">&quot;../../clock&quot;</span>))</span><br></pre></td></tr></table></figure>

<h3 id="nodemon-工具"><a href="#nodemon-工具" class="headerlink" title="nodemon 工具"></a>nodemon 工具</h3><h4 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i nodemon</span><br></pre></td></tr></table></figure>

<h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nodemon app.<span class="property">js</span></span><br></pre></td></tr></table></figure>

<ul>
<li>代码被修改后，会被nodemon监听到，从而实现自动重启的效果</li>
</ul>
<h2 id="express路由"><a href="#express路由" class="headerlink" title="express路由"></a>express路由</h2><h3 id="简介-3"><a href="#简介-3" class="headerlink" title="简介"></a>简介</h3><ul>
<li>路由指的是客户端的请求与服务器处理函数之间的映射关系</li>
<li>分三部分组成，分别是请求的类型、请求的URL、处理函数</li>
<li>例如app.get&#x2F;post都是路由</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">METHOD</span>(<span class="variable constant_">PATH</span>,<span class="variable constant_">HANDLER</span>)</span><br></pre></td></tr></table></figure>

<h3 id="匹配过程"><a href="#匹配过程" class="headerlink" title="匹配过程"></a>匹配过程</h3><ul>
<li>每当一个请求到达服务器后，需要先经过路由的匹配，只有匹配成功之后才会调用对应的处理函数</li>
<li>匹配时会<strong>按照路由的顺序进行匹配</strong>，如果<strong>请求类型和请求的URL同时匹配成功</strong>，则Express会将这次请求交给对应的function函数处理</li>
</ul>
<h3 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h3><h4 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> app=<span class="title function_">express</span>()</span><br><span class="line"><span class="comment">//挂载路由</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express服务器已经启动&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="模块化-1"><a href="#模块化-1" class="headerlink" title="模块化"></a>模块化</h3><ul>
<li><p>为了方便对路由进行模块化的管理，不建议将路由直接挂载到app上，而是推荐抽离为单独的模块</p>
</li>
<li><p>步骤：</p>
</li>
<li><ul>
<li>创建路由模块对应的.js文件</li>
<li>调用express.Router()函数创建路由对象</li>
<li>向路由对象上挂载具体的路由</li>
<li>使用module.exports向外共享路由对象</li>
<li>使用app.use()函数注册路由模块</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express=<span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>)<span class="comment">//导入express</span></span><br><span class="line"><span class="keyword">const</span> router=express.<span class="title class_">Router</span>()<span class="comment">//创建路由对象</span></span><br><span class="line"><span class="comment">//挂载具体路由</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/user/list&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;get user list&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/user/list&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;post user list&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//向外导出路由对象</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>=router</span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"><span class="comment">//导入路由模块</span></span><br><span class="line"><span class="keyword">const</span> userRouter = <span class="built_in">require</span>(<span class="string">&#x27;./router&#x27;</span>)</span><br><span class="line"><span class="comment">//注册路由模块</span></span><br><span class="line">app.<span class="title function_">use</span>(userRouter)</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express服务器开启&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>注意：app.use()函数的作用就是来<strong>注册全局中间件</strong></li>
<li><strong>添加前缀：和为静态资源添加前缀一样</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>,userRouter)</span><br></pre></td></tr></table></figure>

<h2 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h2><ul>
<li>概念：业务流程的中间处理环节</li>
<li>调用流程：当一个请求到达express的服务器之后，可连续调用多个中间件，从而对这次请求进行预处理</li>
<li><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678110481894-68102a2b-e0f0-4669-b4a5-cbe46c7c4122.png" alt="img"></li>
<li>格式：本质上就是一个function处理函数</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678110528257-b94c2e28-3d8a-45dd-a663-97b6369a50f0.png" alt="img"></p>
<ul>
<li><ul>
<li>中间件函数的形参列表中必须包含next参数，而路由处理函数中只包含req和res</li>
<li>next函数：是实现多个中间件连续调用的关键，它表示把流转关系转交给下一个中间件或路由</li>
</ul>
</li>
</ul>
<h3 id="定义中间件函数"><a href="#定义中间件函数" class="headerlink" title="定义中间件函数"></a>定义中间件函数</h3><ul>
<li>最简单的</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> app=<span class="title function_">express</span>()</span><br><span class="line"><span class="comment">//定义一个最简单的中间件函数</span></span><br><span class="line"><span class="keyword">const</span> mw=<span class="keyword">function</span>(<span class="params">req,res,next</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;这是最简单的中间件函数&quot;</span>)</span><br><span class="line">    <span class="comment">//把流转关系转交给下一个中间件或路由</span></span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listten</span>(<span class="number">80</span>,<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express服务器开启&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="全局生效的中间件：客户端发起的任何请求，到达服务器之后都会触发的中间件"><a href="#全局生效的中间件：客户端发起的任何请求，到达服务器之后都会触发的中间件" class="headerlink" title="全局生效的中间件：客户端发起的任何请求，到达服务器之后都会触发的中间件"></a>全局生效的中间件：客户端发起的任何请求，到达服务器之后都会触发的中间件</h4><ul>
<li>通过app.use(中间件函数)，即可定义一个中间件函数</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mw=<span class="keyword">function</span>(<span class="params">req,res,next</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;这是最简单的中间件函数&quot;</span>)</span><br><span class="line">    <span class="comment">//把流转关系转交给下一个中间件或路由</span></span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//将mw注册为全局生效的中间件</span></span><br><span class="line">app.<span class="title function_">use</span>(mw)</span><br></pre></td></tr></table></figure>

<ul>
<li>简化形式</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;简化版的中间件&quot;</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>作用</p>
</li>
<li><ul>
<li>多个中间件之间，共享同一份req和res。基于这样的特性，我们可以在上有的中间件中，统一为req或res对象添加自定义的属性或方法，共下游的中间件或路由进行使用</li>
</ul>
</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678111642669-640de66b-8d8d-4274-8914-fd5235ffa260.png" alt="img"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> time=<span class="title class_">Date</span>.<span class="title function_">now</span>()<span class="comment">//获取请求到达服务器的时间</span></span><br><span class="line">    <span class="comment">//为req对象挂载自定义属性</span></span><br><span class="line">    req.<span class="property">startTime</span>=time</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;post&quot;</span>+req.<span class="property">startTime</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="局部生效的中间件：不使用app-use-定义的中间件"><a href="#局部生效的中间件：不使用app-use-定义的中间件" class="headerlink" title="局部生效的中间件：不使用app.use()定义的中间件"></a>局部生效的中间件：不使用app.use()定义的中间件</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"><span class="keyword">const</span> mw = <span class="keyword">function</span> (<span class="params">req, res, next</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;局部生效中间件&quot;</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, mw, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;get&quot;</span>)</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;Home page&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//mw只会在&#x27;/&#x27;中生效</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/user&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;user page&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express服务器开启&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>定义多个局部中间件：数组或 参数列表</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mw = <span class="keyword">function</span> (<span class="params">req, res, next</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;中间件&quot;</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> mw1 = <span class="keyword">function</span> (<span class="params">req, res, next</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;中间件1&quot;</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, mw,mw1, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;get&quot;</span>)</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;Home page&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, [mw,mw1], <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;get&quot;</span>)</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;Home page&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="分类-1"><a href="#分类-1" class="headerlink" title="分类"></a>分类</h3><h4 id="应用级别"><a href="#应用级别" class="headerlink" title="应用级别"></a>应用级别</h4><ul>
<li>通过app.use或app.get或app.post绑定到app实例上的中间件</li>
</ul>
<h4 id="路由级别"><a href="#路由级别" class="headerlink" title="路由级别"></a>路由级别</h4><ul>
<li>绑定到express.Router实例上的中间件</li>
<li>用法和应用级别中间件没有任何区别</li>
</ul>
<h4 id="错误级别"><a href="#错误级别" class="headerlink" title="错误级别"></a>错误级别</h4><ul>
<li>专门用来捕获项目中发生的异常错误，从而防止项目异常崩溃的问题</li>
<li>错误级别中间件的function函数中必须有四个形参（err,req,res,next）</li>
<li><strong>必须注册在所有路由之后</strong></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express=<span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> app=<span class="title function_">express</span>()</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//人为的制造错误</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;服务器内部发生了错误&quot;</span>)</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;Home page&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//定义错误级别的中间件捕获整个项目的异常错误</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">err,req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;发生了错误:&quot;</span>+err.<span class="property">message</span>)</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;Error:&quot;</span>+err.<span class="property">message</span>)</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express服务器开启&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="Express内置"><a href="#Express内置" class="headerlink" title="Express内置"></a>Express内置</h4><ul>
<li>express.static():快速托管静态资源</li>
<li>express.json:解析JSON格式(application&#x2F;json)的请求体数据（有兼容性，仅在4.116.0+版本中可用)并挂载到req.body上</li>
<li>express.urlencoded：解析URL-encoded格式的请求体数据（有兼容性，仅在4.116.0+版本中可用)—基于第三方中间件body-parser封装的</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123;extended：<span class="literal">false</span>&#125;)</span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//注意：除了错误级别的中间件，其他的中间件必须在路由之前进行配置</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>())</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/user&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//服务器可以使用req.body这个属性来接受客户端发送过来的请求体数据</span></span><br><span class="line">    <span class="comment">//默认情况下，如果不配置解析表单数据的中间件，则req.body默认等于undefined</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>)</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;ok&quot;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extends</span>: <span class="literal">false</span> &#125;))</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/book&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//服务器可以使用req.body这个属性来接受客户端发送过来的请求体数据</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>)</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express服务器开启&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="第三方"><a href="#第三方" class="headerlink" title="第三方"></a>第三方</h4><ul>
<li><p>第三方开发出来的中间件，可以按需下载并配置第三方中间件</p>
</li>
<li><p>步骤：</p>
</li>
<li><ul>
<li>运行npm i 安装中间件</li>
<li>使用require导入中间件</li>
<li>调用app.use()调用并使用中间件</li>
</ul>
</li>
</ul>
<h3 id="自定义中间件"><a href="#自定义中间件" class="headerlink" title="自定义中间件"></a>自定义中间件</h3><p><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678114770635-41bc5af2-4bf5-41bb-ac2f-079966add9fe.png" alt="img"></p>
<h4 id="定义中间件"><a href="#定义中间件" class="headerlink" title="定义中间件"></a>定义中间件</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req,res,next</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//定义中间件的业务逻辑</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="监听req的data事件"><a href="#监听req的data事件" class="headerlink" title="监听req的data事件"></a>监听req的data事件</h4><ul>
<li><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678114901908-18498e8a-be91-48ac-bbdc-0359ea55cd5e.png" alt="img"></li>
</ul>
<h4 id="监听req的end事件"><a href="#监听req的end事件" class="headerlink" title="监听req的end事件"></a>监听req的end事件</h4><p><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678115051948-a6034065-35c8-498a-8f1c-83f52462b8a7.png" alt="img"></p>
<h4 id="使用querystring模块解析请求体数据"><a href="#使用querystring模块解析请求体数据" class="headerlink" title="使用querystring模块解析请求体数据"></a>使用querystring模块解析请求体数据</h4><p><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678115202479-044b4d88-5bcf-472b-8b20-41752bf0e427.png" alt="img"></p>
<h4 id="将解析出来的数据对象挂在为req-body"><a href="#将解析出来的数据对象挂在为req-body" class="headerlink" title="将解析出来的数据对象挂在为req.body"></a>将解析出来的数据对象挂在为req.body</h4><p><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678115302155-ced18aeb-b55b-4944-9919-d1473639fb00.png" alt="img"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> qs = <span class="built_in">require</span>(<span class="string">&quot;querystring&quot;</span>)</span><br><span class="line"><span class="comment">//定义中间件</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">bodyparser</span> = (<span class="params">req, res, next</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">//定义中间件的业务逻辑</span></span><br><span class="line">    <span class="comment">//定义变量，用来存储客户端发送过来的请求体数据</span></span><br><span class="line">    <span class="keyword">let</span> str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="comment">//监听req的data事件</span></span><br><span class="line">    req.<span class="title function_">on</span>(<span class="string">&quot;data&quot;</span>, <span class="function">(<span class="params">chunk</span>) =&gt;</span> &#123;</span><br><span class="line">        str += chunk</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">//监听req的end事件</span></span><br><span class="line">    req.<span class="title function_">on</span>(<span class="string">&quot;end&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//存放的是完整的请求体数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//把字符串格式的请求体数据解析成对象格式</span></span><br><span class="line">        <span class="keyword">const</span> body = qs.<span class="title function_">parse</span>(str)</span><br><span class="line">        req.<span class="property">body</span> = body</span><br><span class="line">        <span class="title function_">next</span>()</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>=bodyparser</span><br></pre></td></tr></table></figure>

<h2 id="编写接口"><a href="#编写接口" class="headerlink" title="编写接口"></a>编写接口</h2><h3 id="创建API路由"><a href="#创建API路由" class="headerlink" title="创建API路由"></a>创建API路由</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express=<span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> app=<span class="title function_">express</span>()</span><br><span class="line"><span class="keyword">const</span> router=express.<span class="title class_">Router</span>()</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>=router</span><br></pre></td></tr></table></figure>

<h3 id="编写get接口"><a href="#编写get接口" class="headerlink" title="编写get接口"></a>编写get接口</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express=<span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> router=express.<span class="title class_">Router</span>()</span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/get&#x27;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//拿到客户端通过查询字符串发送到服务器的数据</span></span><br><span class="line">    <span class="keyword">const</span> query=req.<span class="property">query</span></span><br><span class="line">    <span class="comment">//调用res.send方法响应结果</span></span><br><span class="line">    res.<span class="title function_">send</span>(&#123;</span><br><span class="line">        <span class="attr">status</span>:<span class="number">0</span>,<span class="comment">//0表示处理成功，1表示处理失败</span></span><br><span class="line">        <span class="attr">msg</span>:<span class="string">&quot;GET请求成功&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>:query<span class="comment">//相应给客户端的数据</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>=router</span><br></pre></td></tr></table></figure>

<h3 id="编写post接口"><a href="#编写post接口" class="headerlink" title="编写post接口"></a>编写post接口</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express=<span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> router=express.<span class="title class_">Router</span>()</span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/post&quot;</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="comment">//通过req.body获取请求体上的url-encoded格式的数据</span></span><br><span class="line">    <span class="keyword">const</span> body=req.<span class="property">body</span></span><br><span class="line">    res.<span class="title function_">send</span>(&#123;</span><br><span class="line">        <span class="attr">status</span>:<span class="number">0</span>,</span><br><span class="line">        <span class="attr">msg</span>:<span class="string">&quot;Post请求成功&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>:body</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span>=router</span><br></pre></td></tr></table></figure>

<ul>
<li>注意：必须要配置解析表单数据的中间件</li>
</ul>
<h3 id="解决跨域"><a href="#解决跨域" class="headerlink" title="解决跨域"></a>解决跨域</h3><h4 id="接口的跨域问题"><a href="#接口的跨域问题" class="headerlink" title="接口的跨域问题"></a>接口的跨域问题</h4><ul>
<li>前端调用的后端接口不属于同一个域（域名或端口不同），就会产生跨域问题，也就是说你的应用访问了该应用域名或端口之外的域名或端口。</li>
<li>要同时满足三个条件才会产生跨域问题，这也就是为什么会产生跨域的原因。</li>
<li>1、浏览器限制，而不是服务端限制，可以查看Network，请求能够正确响应，response返回的值也是正确的</li>
<li>2、请求地址的域名或端口和当前访问的域名或端口不一样</li>
<li>3、发送的是XHR（XMLHttpRequest）请求，可以使用 a 标签（模拟xhr请求）和 img 标签（模拟json请求）做对比（控制台只报了一个跨域异常）</li>
</ul>
<h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><ul>
<li>CORS(主流方案)</li>
<li>JSONP（只支持GET请求)</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678261848041-32b23dfc-60c8-48c6-a6b2-0167c0321cd5.png" alt="img"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678261898929-6446be59-a3d9-4ff1-a74c-6c824bd1a5b2.png" alt="img"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678261998734-40bfba44-941f-481f-9825-9da527a3d2ab.png" alt="img"></p>
<h4 id="cors"><a href="#cors" class="headerlink" title="cors"></a>cors</h4><ul>
<li><p>定义：Cross-Origin Resource Sharing 跨域资源共享）<strong>由一系列HTTP响应头组成，决定浏览器是否阻止前端js代码跨域获取资源</strong></p>
</li>
<li><p>**浏览器的同源安全策略默认会组织网页跨域获取资源，但是如果配置了CORS相关的HTTP响应头就可以解除0浏览器端的跨域访问限制</p>
<p>**<img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678260958303-929d1118-d8dc-4da4-b5dc-95549be8280c.png" alt="img"></p>
</li>
<li><p>cors是express的一个第三方中间件,使用app.use()注册</p>
</li>
<li><p>一定要在路由之前配置，从而解决接口跨域的问题</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm i cors</span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&quot;cors&quot;</span>)</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>())</span><br></pre></td></tr></table></figure>

<ul>
<li><p>注意点：</p>
</li>
<li><ul>
<li>主要在服务器端进行配置</li>
<li>cors在浏览器中有兼容性，只有支持XMLHttpRequest Level2的浏览器才能正常访问开启了cors的服务端接口</li>
</ul>
</li>
</ul>
<h5 id="相关的响应头"><a href="#相关的响应头" class="headerlink" title="相关的响应头"></a>相关的响应头</h5><ul>
<li><p>Access-Control-Allow-Origin</p>
</li>
<li><ul>
<li>origin参数的值指定了允许访问该资源的外域URL</li>
<li>如果制定了字段的值为通配符*，表示允许来自任何域的请求</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>,<span class="string">&quot;URL&quot;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Access-Control-Allow-Headers:</p>
</li>
<li><ul>
<li>默认情况下，CORS金支持客户端向服务器发送如下的9个请求头</li>
<li><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678261226886-294c08a0-2a77-4d3e-a7fa-a7e7e943a1d1.png" alt="img"></li>
<li>如果客户端向服务器发送了额外的请求头信息，则需要在服务器端对额外的请求头进行声明</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>,<span class="string">&quot;Headers&quot;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Access-Control-Allow-Methods:</p>
</li>
<li><ul>
<li>默认情况下，CORS金支持客户端发起GET,POST,HEAD请求</li>
<li>如果客户端希望通过PUT、DELETE等方式请求服务器的资源，则需要在服务器端指明请求所允许的HTTP方法</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res.<span class="title function_">setHeader</span>(<span class="string">&quot;Access-Control-Allow-Methods&quot;</span>,<span class="string">&quot;Methods&quot;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="分类-2"><a href="#分类-2" class="headerlink" title="分类"></a>分类</h5><ul>
<li><p>简单请求：</p>
</li>
<li><ul>
<li>请求方式：GET、POST、HEAD三者之一</li>
<li>HTTP头部信息不超过九种字段</li>
</ul>
</li>
<li><p>预检请求：</p>
</li>
<li><ul>
<li>请求方式为GET&#x2F;POST&#x2F;HEAD三者之外</li>
<li>请求头中包含自定义头部字段</li>
<li>向服务器发送了application&#x2F;json格式的数据</li>
<li>在浏览器与服务器正是通信之前，浏览器会先<strong>发送OPTION请求进行预检，以获知服务器是否允许该实际请求</strong>，所以这一次的OPTION请求成为“预检请求”。<strong>服务器成功响应预检请求后才会发送真正的请求并携带真实数据</strong></li>
</ul>
</li>
<li><p><strong>简单请求与预检请求的区别：</strong></p>
</li>
<li><ul>
<li><strong>简单请求客户端与服务器之间只会发生一次请求，而预检请求会发送两次</strong></li>
</ul>
</li>
</ul>
<h1 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h1><h2 id="基本概念-1"><a href="#基本概念-1" class="headerlink" title="基本概念"></a>基本概念</h2><ul>
<li>数据库（database）：是用来组织、存储、管理数据的仓库</li>
</ul>
<h3 id="数据组织结构"><a href="#数据组织结构" class="headerlink" title="数据组织结构"></a>数据组织结构</h3><ul>
<li>数据库、数据表(table)、数据行(row)、字段(field)</li>
<li>不同的数据要存储到不同表中</li>
<li>每个表中具体寸尺那些信息，由字段来决定那个</li>
<li>表中的行代表具体数据</li>
</ul>
<h3 id="基本使用-1"><a href="#基本使用-1" class="headerlink" title="基本使用"></a>基本使用</h3><ul>
<li><p>字段的特殊标识：</p>
</li>
<li><ul>
<li>PK：主键</li>
<li>NN(not null)：值不允许为空</li>
<li>UQ（Unique):值唯一</li>
<li>AI(auto increment):值自动增长</li>
</ul>
</li>
</ul>
<h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><h3 id="什么是SQL"><a href="#什么是SQL" class="headerlink" title="什么是SQL"></a>什么是SQL</h3><ul>
<li>sql(structure query language)：结构化查询语言，是专门用来访问和处理数据库的编程语言</li>
<li>是一门数据库编程语言</li>
<li>使用sql语言编写出来的代码叫做sql语句</li>
<li>只能在关系型数据库中使用</li>
<li>可以用来<strong>增删改查、创建数据库、创建表、存储过程、视图</strong></li>
</ul>
<h3 id="SELECT语句"><a href="#SELECT语句" class="headerlink" title="SELECT语句"></a>SELECT语句</h3><h4 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h4><ul>
<li>SELECT语句用于从表中查询数据，执行的结果被存储在一个结果表中（称为结果集）</li>
<li>对大小写不敏感</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">-</span> <span class="operator">-</span> 从指定的表中查询所有的数据</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表名称</span><br><span class="line"><span class="operator">-</span> <span class="operator">-</span> 从指定的表中查询指定列的数据</span><br><span class="line"><span class="keyword">SELECT</span> 列名称 <span class="keyword">FROM</span> 表名称</span><br></pre></td></tr></table></figure>

<h3 id="INSERT-INTO语句"><a href="#INSERT-INTO语句" class="headerlink" title="INSERT INTO语句"></a>INSERT INTO语句</h3><ul>
<li>insert into 语句用于向数据表中插入新的数据行</li>
</ul>
<h4 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h4><ul>
<li>向指定的表中插入如下几列数据</li>
<li>列和值要一一对应，多个列和多个值之间使用英文的逗号分隔</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table_name (列<span class="number">1.</span>...列n) <span class="keyword">VALUES</span> (值<span class="number">1.</span>.....)</span><br></pre></td></tr></table></figure>

<h3 id="UPDATE语句"><a href="#UPDATE语句" class="headerlink" title="UPDATE语句"></a>UPDATE语句</h3><ul>
<li>update语句用于修改表中的数据</li>
</ul>
<h4 id="语法-2"><a href="#语法-2" class="headerlink" title="语法"></a>语法</h4><ul>
<li>update指定要更新哪个表中的数据</li>
<li>用set指定列对应的新值</li>
<li>用where指定更新的条件</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> 表名称 <span class="keyword">SET</span> 列名称 <span class="operator">=</span> 新值 <span class="keyword">WHERE</span> 列名称<span class="operator">=</span>某值</span><br></pre></td></tr></table></figure>

<h3 id="DELETE语句"><a href="#DELETE语句" class="headerlink" title="DELETE语句"></a>DELETE语句</h3><ul>
<li>用于删除表里的行</li>
</ul>
<h4 id="语法-3"><a href="#语法-3" class="headerlink" title="语法"></a>语法</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> 表名称 <span class="keyword">WHERE</span> 列名<span class="operator">=</span>值</span><br></pre></td></tr></table></figure>

<h3 id="WHERE子句"><a href="#WHERE子句" class="headerlink" title="WHERE子句"></a>WHERE子句</h3><ul>
<li>用于限定选择的标准，在select&#x2F;update&#x2F;delete中那节课使用where字句来限定选择的标准</li>
<li>可以使用的运算符：&#x3D; &lt;&gt;(不等于) &gt; &lt; &gt;&#x3D; &lt;&#x3D; BETWEEN LIKE</li>
</ul>
<h4 id="and-x2F-or运算符"><a href="#and-x2F-or运算符" class="headerlink" title="and&#x2F;or运算符"></a>and&#x2F;or运算符</h4><ul>
<li>可在where语句中把两个或多个条件结合起来</li>
<li>and表示必须同时满足多个条件</li>
<li>or表示只要满足其中一个条件就可以</li>
</ul>
<h3 id="order-BY-字句"><a href="#order-BY-字句" class="headerlink" title="order BY 字句"></a>order BY 字句</h3><ul>
<li>用于根据指定的列对结果集进行排序</li>
<li>默认按照升序对记录进行排序，如果希望降序，那么可以使用<strong>DESC关键字（ASC是升序)</strong></li>
</ul>
<h4 id="多重排序"><a href="#多重排序" class="headerlink" title="多重排序"></a>多重排序</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> id;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> id <span class="keyword">desc</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> name,id <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure>

<h3 id="COUNT-函数"><a href="#COUNT-函数" class="headerlink" title="COUNT(*)函数"></a>COUNT(*)函数</h3><ul>
<li>用于返回查询结果的总数据条数</li>
<li>语法：SELECT COUNT(*) FROM 表名称</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<h3 id="AS关键字"><a href="#AS关键字" class="headerlink" title="AS关键字"></a>AS关键字</h3><ul>
<li>可以用来设置别名</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> TOTAL <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<h2 id="mysql模块"><a href="#mysql模块" class="headerlink" title="mysql模块"></a>mysql模块</h2><h3 id="安装第三方模块mysql"><a href="#安装第三方模块mysql" class="headerlink" title="安装第三方模块mysql"></a>安装第三方模块mysql</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i mysql</span><br></pre></td></tr></table></figure>

<h3 id="配置mysql模块"><a href="#配置mysql模块" class="headerlink" title="配置mysql模块"></a>配置mysql模块</h3><ul>
<li><p>导入mysql模块</p>
</li>
<li><p>建立连接</p>
</li>
<li><ul>
<li>host:数据库的ip地址</li>
<li>user:登录数据库的账号</li>
<li>password:密码</li>
<li>database:要登陆的数据库</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mysql = <span class="built_in">require</span>(<span class="string">&quot;mysql&quot;</span>)<span class="comment">//导入模块</span></span><br><span class="line"><span class="keyword">const</span> db=mysql.<span class="title function_">createPool</span>(&#123;</span><br><span class="line">    <span class="attr">host</span>:<span class="string">&quot;127.0.0.1&quot;</span>,<span class="comment">//数据库的ip地址</span></span><br><span class="line">    <span class="attr">user</span>:<span class="string">&quot;root&quot;</span>,<span class="comment">//登录数据库的账号</span></span><br><span class="line">    <span class="attr">password</span>:<span class="string">&quot;20030319&quot;</span>,<span class="comment">//密码</span></span><br><span class="line">    <span class="attr">database</span>:<span class="string">&quot;my_db&quot;</span><span class="comment">//要登陆的数据库</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>调用db.query()指定要执行的sql语句，通过回调函数拿到执行的结果</p>
</li>
<li><ul>
<li>参数一：要执行的语句</li>
<li>参数二：回调函数，err是错误，results是查询结果</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(<span class="string">&quot;SELECT 1&quot;</span>,<span class="function">(<span class="params">err,results</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err)<span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(results)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="通过mysql模块执行SQL语句"><a href="#通过mysql模块执行SQL语句" class="headerlink" title="通过mysql模块执行SQL语句"></a>通过mysql模块执行SQL语句</h3><h4 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h4><ul>
<li>执行的结果是一个数组</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(<span class="string">&quot;SELECT * FROM user&quot;</span>,<span class="function">(<span class="params">err,results</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err)<span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(results)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h4><ul>
<li>?在sql语句中代表占位符</li>
<li>affectedRows表示影响的列数，可以用来判断是不是插入成功</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123; <span class="attr">name</span>: <span class="string">&quot;spiderman&quot;</span>, <span class="attr">id</span>: <span class="number">8</span>, <span class="attr">status</span>: <span class="number">0</span> &#125;</span><br><span class="line"><span class="keyword">const</span> sqlstr=<span class="string">&quot;INSERT INTO user (name,id,status) values(?,?,?)&quot;</span></span><br><span class="line">db.<span class="title function_">query</span>(sqlstr, [user.<span class="property">name</span>, user.<span class="property">id</span>, user.<span class="property">status</span>],<span class="function">(<span class="params">err,results</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(err)<span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">    <span class="keyword">if</span>(results.<span class="property">affectedRows</span>===<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;插入数据成功&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>快捷插入：如果数据对象的每个属性和数据表的字段一一对应</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const <span class="keyword">user</span> <span class="operator">=</span> &#123; name: &quot;spiderman&quot;, id: <span class="number">8</span>, status: <span class="number">0</span> &#125;</span><br><span class="line">const sqlstr<span class="operator">=</span>&quot;INSERT INTO user SET ?&quot;</span><br><span class="line">db.query(sqlstr, <span class="keyword">user</span>,(err,results)<span class="operator">=</span><span class="operator">&gt;</span>&#123;</span><br><span class="line">    if(err)console.<span class="built_in">log</span>(err.message)</span><br><span class="line">    if(results.affectedRows<span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="number">1</span>)&#123;</span><br><span class="line">        console.<span class="built_in">log</span>(&quot;插入数据成功&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a>更新数据</h4><ul>
<li>执行了update语句之后，执行的结果也是一个对象，也可以通过affectedRows来判断是否更新成功</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123; <span class="attr">name</span>: <span class="string">&quot;1111&quot;</span>, <span class="attr">id</span>: <span class="number">13</span>, <span class="attr">status</span>: <span class="number">1</span> &#125;</span><br><span class="line"><span class="keyword">const</span> sqlstr = <span class="string">&quot;UPDATE user SET  name=? ,status=? where id= ?&quot;</span> <span class="comment">//?在sql语句中表示占位符</span></span><br><span class="line">db.<span class="title function_">query</span>(sqlstr, [user.<span class="property">name</span>,user.<span class="property">status</span>,user.<span class="property">id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">    <span class="keyword">if</span> (results.<span class="property">affectedRows</span> == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;更新数据成功&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li>快捷更新：如果数据对象的每个属性和数据表的字段一一对应</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123; <span class="attr">name</span>: <span class="string">&quot;1111&quot;</span>, <span class="attr">id</span>: <span class="number">13</span>, <span class="attr">status</span>: <span class="number">1</span> &#125;</span><br><span class="line"><span class="keyword">const</span> sqlstr = <span class="string">&quot;UPDATE user SET? where id= ?&quot;</span> <span class="comment">//?在sql语句中表示占位符</span></span><br><span class="line">db.<span class="title function_">query</span>(sqlstr, [user,user.<span class="property">id</span>], <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">    <span class="keyword">if</span> (results.<span class="property">affectedRows</span> == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;更新数据成功&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h4><ul>
<li>推荐根据唯一标识来删除对应的数据</li>
<li>执行delete语句之后，结果也是一个对象，也会包含affectedRows属性</li>
<li>注意：如果sql语句中有对各占位符，则必须使用数组为每个占位符指定具体的值，如果sql语句中只有一个占位符，则可以省略数组</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.<span class="title function_">query</span>(<span class="string">&quot;DELETE FROM user where id=12&quot;</span>, <span class="function">(<span class="params">err, results</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(results)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="标记删除"><a href="#标记删除" class="headerlink" title="标记删除"></a>标记删除</h5><ul>
<li>使用delete会真正的吧数据从表中删除掉，为了保险起见推荐使用标记删除的形式来模拟删除的动作，也就是在表中设置类似于status这样的状态字段来标记当前这条数据是否被删除，当用户执行了删除的动作时我们并没有执行delete语句，二十使用update语句将对应的status字段标记为删除</li>
</ul>
<h1 id="前后端的身份认证"><a href="#前后端的身份认证" class="headerlink" title="前后端的身份认证"></a>前后端的身份认证</h1><h2 id="WEB开发模式"><a href="#WEB开发模式" class="headerlink" title="WEB开发模式"></a>WEB开发模式</h2><h3 id="基于服务端渲染的传统开发模式"><a href="#基于服务端渲染的传统开发模式" class="headerlink" title="基于服务端渲染的传统开发模式"></a>基于服务端渲染的传统开发模式</h3><ul>
<li><p>概念：服务器发送给客户端的html页面，实在服务器通过字符串的拼接动态生成的，客户端不需要使用ajax这样的技术</p>
</li>
<li><p>优点：</p>
</li>
<li><ul>
<li>前端耗时少，因为服务器端负责动态生成HTML内容，浏览器只需要直接渲染页面即可</li>
<li>有利于SEO，因为服务器端相应的的是完整的html页面内容，所以爬虫更容易爬取获得信息</li>
</ul>
</li>
<li><p>缺点：</p>
</li>
<li><ul>
<li>占用服务器端资源，如果请求较多会多服务器造成一定的访问压力</li>
<li>不利于前后端分离，开发效率低</li>
</ul>
</li>
</ul>
<h3 id="基于前后端分离的新型开发模式"><a href="#基于前后端分离的新型开发模式" class="headerlink" title="基于前后端分离的新型开发模式"></a>基于前后端分离的新型开发模式</h3><ul>
<li><p>概念：依赖于ajax技术的广泛应用，后端只负责提供api接口，前端使用ajax调用接口</p>
</li>
<li><p>优点：</p>
</li>
<li><ul>
<li>开发体验好，前端专注于UI页面的开发，后端专注于api的开发</li>
<li>用户体验好，可以轻松实现页面的局部刷新</li>
<li>减轻了服务器端的渲染压力，因为实在用户的浏览器中生成的</li>
</ul>
</li>
<li><p>缺点：</p>
</li>
<li><ul>
<li>不利于seo，因为完整的html页面需要在客户端动态拼接完成，所以爬虫无法爬取页面的有效信息，解决方法是SSR</li>
</ul>
</li>
</ul>
<h3 id="如何选择开发模式"><a href="#如何选择开发模式" class="headerlink" title="如何选择开发模式"></a>如何选择开发模式</h3><ul>
<li>不谈业务场景而盲目选择使用何种开发模式都是耍流氓</li>
<li>企业级网站，主要功能是展示而不是交互，需要良好的seo就需要使用服务器端渲染</li>
<li>后台管理系统，交互性比较强，就可以使用前后端分离</li>
<li>当然也可以两种兼用</li>
</ul>
<h2 id="身份认证"><a href="#身份认证" class="headerlink" title="身份认证"></a>身份认证</h2><ul>
<li>概念：又称鉴权，是指通过一定的手段完成对用户身份的确认</li>
</ul>
<h3 id="不同开发模式下的身份认证"><a href="#不同开发模式下的身份认证" class="headerlink" title="不同开发模式下的身份认证"></a>不同开发模式下的身份认证</h3><ul>
<li>服务端渲染推荐使用Session认证机制</li>
<li>前后端分离推荐使用JWT认证机制</li>
</ul>
<h3 id="Session认证机制"><a href="#Session认证机制" class="headerlink" title="Session认证机制"></a>Session认证机制</h3><h4 id="HTTP协议的无状态性"><a href="#HTTP协议的无状态性" class="headerlink" title="HTTP协议的无状态性"></a>HTTP协议的无状态性</h4><ul>
<li>客户端的每次http请求都是独立的，连续多个请求之间没有直接的关系，服务器不会主动保留每次http请求的状态。</li>
<li>如何突破：服务器主动给客户端发送一个身份认证的标识<strong>Cookie</strong></li>
</ul>
<h5 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h5><ul>
<li><p>Cookie是存储在用户浏览器的一段不超过4KB的字符串，由一个<strong>名称</strong>，一个<strong>值</strong>和其他几个用于控制有效期、安全性、适用范围的<strong>可选属性</strong>组成</p>
</li>
<li><p>不同域名下的cookie各自独立，每当客户端发起请求时，会<strong>自动</strong>把当前域名下<strong>所有未过期的cookie</strong>一同发送到服务器。</p>
</li>
<li><p>特性：</p>
</li>
<li><ul>
<li>自动发送</li>
<li>域名独立</li>
<li>过期时限</li>
<li>4KB限制</li>
</ul>
</li>
<li><p>在身份认证中的作用：</p>
</li>
<li><ul>
<li>客户端在第一次请求服务器的时候，服务器通过响应头的形式向客户端发送一个身份认证的cookie，客户端会自动将Cookie保存在浏览器中。随后，当客户端每次请求服务器是，会自动将身份认证相关的cookie通过请求头的形式发送给服务器，服务器即可验明客户端的身份</li>
</ul>
</li>
<li><p><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678535064606-ad748d7f-00e1-4798-8d85-cfcd14a24f22.png" alt="img"></p>
</li>
<li><p>安全性：</p>
</li>
<li><ul>
<li>不具有安全性，因为浏览器提供的读写cookie的API，因此cookie很容易被伪造。、</li>
</ul>
</li>
</ul>
<h4 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h4><p><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678535459620-caaf2bd5-77e6-4936-9467-7088a5c7bc38.png" alt="img"></p>
<h4 id="express中使用session"><a href="#express中使用session" class="headerlink" title="express中使用session"></a>express中使用session</h4><ul>
<li>安装express-session中间件</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i express<span class="operator">-</span>session</span><br></pre></td></tr></table></figure>

<ul>
<li>配置中间件</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express=<span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> session=<span class="built_in">require</span>(<span class="string">&quot;express-session&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> app=<span class="title function_">express</span>()</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;</span><br><span class="line">  <span class="attr">secret</span>:<span class="string">&quot;test&quot;</span>,<span class="comment">//随意填写</span></span><br><span class="line">  <span class="attr">resave</span>:<span class="literal">false</span>,<span class="comment">//固定写法</span></span><br><span class="line">  <span class="attr">saveUninitialized</span>:<span class="literal">true</span><span class="comment">//固定写法</span></span><br><span class="line">&#125;))</span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>,<span class="function">(<span class="params">req,res</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express服务器开启&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><ul>
<li>配置成功后即可通过req.session来访问和使用session对象</li>
</ul>
</li>
<li><p>清空session：req.session.destory()(只会清空当前用户的session)</p>
</li>
</ul>
<h3 id="JWT认证机制"><a href="#JWT认证机制" class="headerlink" title="JWT认证机制"></a>JWT认证机制</h3><ul>
<li><p>session认证机制需要配合Cookie才能实现，由于cookie默认不支持跨域访问，因此涉及到前端你跨域请求后端接口的时候需要做很多额外的配置才能实现跨域Session认证</p>
</li>
<li><p>定义：（JSON Web Token）是目前最流行的跨域认证解决方案</p>
</li>
<li><p>工作原理：</p>
</li>
<li><ul>
<li>用户的信息通过Token字符串的形式保存在客户端中，服务器通过还原Token的形式来认证用户的身份</li>
</ul>
</li>
<li><p><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678536726478-2b9bb387-57d4-407d-a8f2-4c4b37bef905.png" alt="img"></p>
</li>
<li><p>组成部分：Header、Payload(有效荷载）、Signature(签名)：Header.Payload.Signature</p>
</li>
<li><ul>
<li>Payload部分才是真正的用户信息，是加密后的字符串</li>
<li>Header和signature是安全性相关的部分，只是为了保证Token的安全性</li>
</ul>
</li>
<li><p>使用方式：</p>
</li>
<li><ul>
<li>客户端收到服务器返回的JWT之后通常会存储在localstorage或sessionStorage中，此后客户端每次与服务器通信都要带上这个JWT的字符串。推荐吧JWT放在HTTP请求头的Authorization字段中</li>
</ul>
</li>
</ul>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Authorization:Bearer &lt;token&gt;</span><br></pre></td></tr></table></figure>

<h4 id="在express中使用JWT"><a href="#在express中使用JWT" class="headerlink" title="在express中使用JWT"></a>在express中使用JWT</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i jsonwebtoken express-jwt//</span><br></pre></td></tr></table></figure>

<ul>
<li>第一个包用于生成JWT字符串，第二个包用于将JWT字符串解析还原成JSON对象</li>
</ul>
<h5 id="导入模块"><a href="#导入模块" class="headerlink" title="导入模块"></a>导入模块</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&quot;jsonwebtoken&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123;expressjwt&#125; = <span class="built_in">require</span>(<span class="string">&quot;express-jwt&quot;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="定义secret密钥"><a href="#定义secret密钥" class="headerlink" title="定义secret密钥"></a>定义secret密钥</h5><ul>
<li><p>为保证jwt字符串的安全性，防止JWT字符串在网络传输过程中被别人破解，需要专门定义一个用于加密和解密的secret密钥</p>
</li>
<li><ul>
<li>生成jwt字符串的时候需要使用secret密钥对用户的信息进行加密最终得到加密好的JWT字符串</li>
<li>当把jwt字符串解析还原成JSON对象的时候需要使用secret密钥进行解密</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> secretKey=<span class="string">&quot;hhhsecret&quot;</span><span class="comment">//本质就是字符串</span></span><br></pre></td></tr></table></figure>

<h5 id="生成JWT字符串"><a href="#生成JWT字符串" class="headerlink" title="生成JWT字符串"></a>生成JWT字符串</h5><ul>
<li>jsonwebtoken提供了sign（）方法</li>
<li>参数一”用户信息对象</li>
<li>参数二：加密密钥</li>
<li>参数三：配置对象,可以配置当前token的有效期</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jwt.<span class="title function_">sign</span>(&#123; <span class="attr">username</span>: <span class="string">&quot;user.username&quot;</span> &#125;,secretKey,&#123;<span class="attr">expiresIn</span>:<span class="string">&quot;30s&quot;</span>&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="还原json对象"><a href="#还原json对象" class="headerlink" title="还原json对象"></a>还原json对象</h5><ul>
<li>客户端每次访问有权限接口的时候都需要主动通过请求头中的Authorization字段将token字符串发送到服务器进行身份认证</li>
<li>expressJWT({ secret: secretKey }):用来解析Token</li>
<li>.unless({ path: [&#x2F;^/api/&#x2F;] }):用来指定哪些接口不需要访问权限</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="title function_">expressJWT</span>(&#123; <span class="attr">secret</span>: secretKey，<span class="attr">algorithms</span>:[<span class="string">&quot;HS256&quot;</span>] &#125;).<span class="title function_">unless</span>(&#123; <span class="attr">path</span>: [<span class="regexp">/^\/api\//</span>] &#125;))</span><br></pre></td></tr></table></figure>

<h5 id="获取用户信息"><a href="#获取用户信息" class="headerlink" title="获取用户信息"></a>获取用户信息</h5><ul>
<li>只要配置成功了express-jwt这个中间件，就可以把解析出来的用户信息挂载到req.auth上</li>
</ul>
<h5 id="捕获解析JWT失败后的错误"><a href="#捕获解析JWT失败后的错误" class="headerlink" title="捕获解析JWT失败后的错误"></a>捕获解析JWT失败后的错误</h5><ul>
<li>当使用express-JWT解析token时如果客户端发送的token国企或者不合法会产生一个解析失败的错误，影响项目的正常运行，可以通过Express的错误中间件捕获这个错误并进行相关的处理</li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2023/png/29638251/1678538630854-09a1e1d5-2fe7-40d0-b78c-756907f653c4.png" alt="img"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://www.coderlx.cn">Lx</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://www.coderlx.cn/2023/03/15/Node/">http://www.coderlx.cn/2023/03/15/Node/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.coderlx.cn" target="_blank">LX's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Node/">Node</a></div><div class="post_share"><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-63bff759ac3c2c92" async="async"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2023/02/09/%E5%9B%9E%E6%BA%AF%E7%AE%97%E6%B3%95/"><img class="prev-cover" src="https://www.dmoe.cc/random.php" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">回溯算法</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/index.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Lx</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxqwq"><i></i><span>🛴前往我的github...</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xxqwq" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:2524447983@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><center>主域名：<br><a href="https://www.coderlx.cn"><b><font color="#5ea6e5">coderlx.cn</font></b></a>&nbsp; </center></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Node%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">Node基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E9%A1%BE"><span class="toc-number">1.1.</span> <span class="toc-text">回顾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nodejs%E7%AE%80%E4%BB%8B"><span class="toc-number">1.2.</span> <span class="toc-text">Nodejs简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Node-js%E5%8F%AF%E4%BB%A5%E5%81%9A%E4%BB%80%E4%B9%88"><span class="toc-number">1.3.</span> <span class="toc-text">Node.js可以做什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Buffer-%E7%BC%93%E5%86%B2%E5%8C%BA"><span class="toc-number">1.4.</span> <span class="toc-text">Buffer 缓冲区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%BD%AEAPI%E6%A8%A1%E5%9D%97"><span class="toc-number">1.5.</span> <span class="toc-text">内置API模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#fs%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%A8%A1%E5%9D%97"><span class="toc-number">1.5.1.</span> <span class="toc-text">fs文件系统模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">读取文件内容</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#fs-readFile"><span class="toc-number">1.5.1.1.1.</span> <span class="toc-text">fs.readFile()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#fs-writeFile"><span class="toc-number">1.5.1.1.2.</span> <span class="toc-text">fs.writeFile()</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%EF%BC%9A%E8%80%83%E8%AF%95%E6%88%90%E7%BB%A9%E7%AE%A1%E7%90%86"><span class="toc-number">1.5.1.1.2.1.</span> <span class="toc-text">案例：考试成绩管理</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84%E5%8A%A8%E6%80%81%E6%8B%BC%E6%8E%A5%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.5.1.1.3.</span> <span class="toc-text">路径动态拼接的问题</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#path%E6%A8%A1%E5%9D%97"><span class="toc-number">1.5.2.</span> <span class="toc-text">path模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">简介</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#path-join"><span class="toc-number">1.5.2.1.1.</span> <span class="toc-text">path.join()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#path-basename"><span class="toc-number">1.5.2.1.2.</span> <span class="toc-text">path.basename()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#path-extname"><span class="toc-number">1.5.2.1.3.</span> <span class="toc-text">path.extname()</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#http%E6%A8%A1%E5%9D%97"><span class="toc-number">1.5.3.</span> <span class="toc-text">http模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9B%B8%E5%85%B3%E7%9A%84%E6%A6%82%E5%BF%B5%EF%BC%9A"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">服务器相关的概念：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAweb%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">创建web服务器</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5http%E6%A8%A1%E5%9D%97"><span class="toc-number">1.5.3.2.1.</span> <span class="toc-text">导入http模块</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAweb%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.5.3.2.2.</span> <span class="toc-text">创建web服务器实例</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BA%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%9E%E4%BE%8B%E7%BB%91%E5%AE%9Arequest%E4%BA%8B%E4%BB%B6%EF%BC%8C%E7%9B%91%E5%90%AC%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9A%84%E8%AF%B7%E6%B1%82"><span class="toc-number">1.5.3.2.3.</span> <span class="toc-text">为服务器实例绑定request事件，监听客户端的请求</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.5.3.2.4.</span> <span class="toc-text">启动服务器</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE%E4%B8%8D%E5%90%8C%E7%9A%84url%E5%93%8D%E5%BA%94%E4%B8%8D%E5%90%8C%E7%9A%84html%E5%86%85%E5%AE%B9"><span class="toc-number">1.5.3.3.</span> <span class="toc-text">根据不同的url响应不同的html内容</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90%EF%BC%9A%E6%97%B6%E9%92%9Fweb%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%A1%88%E4%BE%8B"><span class="toc-number">1.5.3.3.1.</span> <span class="toc-text">例子：时钟web服务器案例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%8C%96"><span class="toc-number">1.5.4.</span> <span class="toc-text">模块化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.5.4.1.</span> <span class="toc-text">基本概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%8C%96%E8%A7%84%E8%8C%83"><span class="toc-number">1.5.4.2.</span> <span class="toc-text">模块化规范</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Node%E4%B8%AD%E7%9A%84%E6%A8%A1%E5%9D%97%E5%8C%96"><span class="toc-number">1.5.4.3.</span> <span class="toc-text">Node中的模块化</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E7%B1%BB"><span class="toc-number">1.5.4.3.1.</span> <span class="toc-text">分类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97"><span class="toc-number">1.5.4.3.2.</span> <span class="toc-text">加载模块</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">1.5.4.3.3.</span> <span class="toc-text">模块作用域</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#module%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.5.4.3.4.</span> <span class="toc-text">module对象</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#module-exports%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.5.4.3.4.1.</span> <span class="toc-text">module.exports对象</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#exports%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.5.4.3.5.</span> <span class="toc-text">exports对象</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E4%B8%8Enpm"><span class="toc-number">1.5.4.3.6.</span> <span class="toc-text">包与npm</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-1"><span class="toc-number">1.5.4.3.6.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90%EF%BC%9A%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%97%B6%E9%97%B4%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95"><span class="toc-number">1.5.4.3.6.2.</span> <span class="toc-text">例子：格式化时间的两种方法</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="toc-number">1.5.4.3.6.3.</span> <span class="toc-text">注意点</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8C%85%E7%AE%A1%E7%90%86%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.5.4.3.6.4.</span> <span class="toc-text">包管理配置文件</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8D%B8%E8%BD%BD"><span class="toc-number">1.5.4.3.6.5.</span> <span class="toc-text">卸载</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%88%87%E6%8D%A2%E9%95%9C%E5%83%8F%E6%BA%90"><span class="toc-number">1.5.4.3.6.6.</span> <span class="toc-text">切换镜像源</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8C%85%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">1.5.4.3.6.7.</span> <span class="toc-text">包的分类</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%A7%84%E8%8C%83%E7%9A%84%E5%8C%85%E7%BB%93%E6%9E%84"><span class="toc-number">1.5.4.3.6.8.</span> <span class="toc-text">规范的包结构</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E4%B8%80%E4%B8%AA%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8C%85"><span class="toc-number">1.5.4.3.6.9.</span> <span class="toc-text">开发一个自己的包</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E7%9A%84%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6"><span class="toc-number">1.5.4.3.7.</span> <span class="toc-text">模块的加载机制</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BC%98%E5%85%88%E4%BB%8E%E7%BC%93%E5%AD%98%E4%B8%AD%E5%8A%A0%E8%BD%BD"><span class="toc-number">1.5.4.3.7.1.</span> <span class="toc-text">优先从缓存中加载</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97%E5%8A%A0%E8%BD%BD%E4%BC%98%E5%85%88%E7%BA%A7%E6%9C%80%E9%AB%98"><span class="toc-number">1.5.4.3.7.2.</span> <span class="toc-text">内置模块加载优先级最高</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9D%97%EF%BC%8C%E5%BF%85%E9%A1%BB%E6%8C%87%E5%AE%9A-x2F-%E6%88%96-x2F-%E5%BC%80%E5%A4%B4%E7%9A%84%E8%B7%AF%E5%BE%84%E6%A0%87%E8%AF%86%E7%AC%A6%EF%BC%8C%E5%90%A6%E5%88%99%E4%BC%9A%E5%BD%93%E6%88%90%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97%E6%88%96%E8%80%85%E7%AC%AC%E4%B8%89%E6%96%B9%E6%A8%A1%E5%9D%97%E5%8A%A0%E8%BD%BD"><span class="toc-number">1.5.4.3.7.3.</span> <span class="toc-text">加载自定义模块，必须指定.&#x2F;或.&#x2F;开头的路径标识符，否则会当成内置模块或者第三方模块加载</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E7%AC%AC%E4%B8%89%E6%96%B9%E6%A8%A1%E5%9D%97"><span class="toc-number">1.5.4.3.7.4.</span> <span class="toc-text">加载第三方模块</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E4%BD%9C%E4%B8%BA%E6%A8%A1%E5%9D%97"><span class="toc-number">1.5.4.3.7.5.</span> <span class="toc-text">目录作为模块</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Express"><span class="toc-number">2.</span> <span class="toc-text">Express</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E8%AF%86express"><span class="toc-number">2.1.</span> <span class="toc-text">初识express</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-2"><span class="toc-number">2.1.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">2.1.2.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9F%BA%E6%9C%AC%E7%9A%84Web%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">2.1.3.</span> <span class="toc-text">创建基本的Web服务器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%91%E5%90%ACGET%E8%AF%B7%E6%B1%82%E5%92%8CPost%E8%AF%B7%E6%B1%82"><span class="toc-number">2.1.4.</span> <span class="toc-text">监听GET请求和Post请求</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%8A%E5%86%85%E5%AE%B9%E5%93%8D%E5%BA%94%E7%BB%99%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">2.1.4.1.</span> <span class="toc-text">把内容响应给客户端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96URL%E4%B8%AD%E6%90%BA%E5%B8%A6%E7%9A%84%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0"><span class="toc-number">2.1.4.2.</span> <span class="toc-text">获取URL中携带的查询参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96URL%E4%B8%AD%E6%90%BA%E5%B8%A6%E7%9A%84%E5%8A%A8%E6%80%81%E5%8F%82%E6%95%B0"><span class="toc-number">2.1.4.3.</span> <span class="toc-text">获取URL中携带的动态参数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%98%E7%AE%A1%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90"><span class="toc-number">2.1.5.</span> <span class="toc-text">托管静态资源</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#express-static"><span class="toc-number">2.1.5.1.</span> <span class="toc-text">express.static()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nodemon-%E5%B7%A5%E5%85%B7"><span class="toc-number">2.1.6.</span> <span class="toc-text">nodemon 工具</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-1"><span class="toc-number">2.1.6.1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="toc-number">2.1.6.2.</span> <span class="toc-text">使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#express%E8%B7%AF%E7%94%B1"><span class="toc-number">2.2.</span> <span class="toc-text">express路由</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-3"><span class="toc-number">2.2.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E8%BF%87%E7%A8%8B"><span class="toc-number">2.2.2.</span> <span class="toc-text">匹配过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-1"><span class="toc-number">2.2.3.</span> <span class="toc-text">使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">2.2.3.1.</span> <span class="toc-text">基本使用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%8C%96-1"><span class="toc-number">2.2.4.</span> <span class="toc-text">模块化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">2.3.</span> <span class="toc-text">中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%87%BD%E6%95%B0"><span class="toc-number">2.3.1.</span> <span class="toc-text">定义中间件函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E7%94%9F%E6%95%88%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%EF%BC%9A%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%8F%91%E8%B5%B7%E7%9A%84%E4%BB%BB%E4%BD%95%E8%AF%B7%E6%B1%82%EF%BC%8C%E5%88%B0%E8%BE%BE%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B9%8B%E5%90%8E%E9%83%BD%E4%BC%9A%E8%A7%A6%E5%8F%91%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">2.3.1.1.</span> <span class="toc-text">全局生效的中间件：客户端发起的任何请求，到达服务器之后都会触发的中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%80%E9%83%A8%E7%94%9F%E6%95%88%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%EF%BC%9A%E4%B8%8D%E4%BD%BF%E7%94%A8app-use-%E5%AE%9A%E4%B9%89%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">2.3.1.2.</span> <span class="toc-text">局部生效的中间件：不使用app.use()定义的中间件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%B1%BB-1"><span class="toc-number">2.3.2.</span> <span class="toc-text">分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E7%BA%A7%E5%88%AB"><span class="toc-number">2.3.2.1.</span> <span class="toc-text">应用级别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E7%BA%A7%E5%88%AB"><span class="toc-number">2.3.2.2.</span> <span class="toc-text">路由级别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%94%99%E8%AF%AF%E7%BA%A7%E5%88%AB"><span class="toc-number">2.3.2.3.</span> <span class="toc-text">错误级别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Express%E5%86%85%E7%BD%AE"><span class="toc-number">2.3.2.4.</span> <span class="toc-text">Express内置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%96%B9"><span class="toc-number">2.3.2.5.</span> <span class="toc-text">第三方</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">2.3.3.</span> <span class="toc-text">自定义中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">2.3.3.1.</span> <span class="toc-text">定义中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%91%E5%90%ACreq%E7%9A%84data%E4%BA%8B%E4%BB%B6"><span class="toc-number">2.3.3.2.</span> <span class="toc-text">监听req的data事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%91%E5%90%ACreq%E7%9A%84end%E4%BA%8B%E4%BB%B6"><span class="toc-number">2.3.3.3.</span> <span class="toc-text">监听req的end事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8querystring%E6%A8%A1%E5%9D%97%E8%A7%A3%E6%9E%90%E8%AF%B7%E6%B1%82%E4%BD%93%E6%95%B0%E6%8D%AE"><span class="toc-number">2.3.3.4.</span> <span class="toc-text">使用querystring模块解析请求体数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%86%E8%A7%A3%E6%9E%90%E5%87%BA%E6%9D%A5%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AF%B9%E8%B1%A1%E6%8C%82%E5%9C%A8%E4%B8%BAreq-body"><span class="toc-number">2.3.3.5.</span> <span class="toc-text">将解析出来的数据对象挂在为req.body</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.4.</span> <span class="toc-text">编写接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAAPI%E8%B7%AF%E7%94%B1"><span class="toc-number">2.4.1.</span> <span class="toc-text">创建API路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%86%99get%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.4.2.</span> <span class="toc-text">编写get接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%86%99post%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.4.3.</span> <span class="toc-text">编写post接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F"><span class="toc-number">2.4.4.</span> <span class="toc-text">解决跨域</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E7%9A%84%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98"><span class="toc-number">2.4.4.1.</span> <span class="toc-text">接口的跨域问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">2.4.4.2.</span> <span class="toc-text">解决方案</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cors"><span class="toc-number">2.4.4.3.</span> <span class="toc-text">cors</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E7%9A%84%E5%93%8D%E5%BA%94%E5%A4%B4"><span class="toc-number">2.4.4.3.1.</span> <span class="toc-text">相关的响应头</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E7%B1%BB-2"><span class="toc-number">2.4.4.3.2.</span> <span class="toc-text">分类</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">3.</span> <span class="toc-text">数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5-1"><span class="toc-number">3.1.</span> <span class="toc-text">基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%84%E7%BB%87%E7%BB%93%E6%9E%84"><span class="toc-number">3.1.1.</span> <span class="toc-text">数据组织结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8-1"><span class="toc-number">3.1.2.</span> <span class="toc-text">基本使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL"><span class="toc-number">3.2.</span> <span class="toc-text">SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFSQL"><span class="toc-number">3.2.1.</span> <span class="toc-text">什么是SQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SELECT%E8%AF%AD%E5%8F%A5"><span class="toc-number">3.2.2.</span> <span class="toc-text">SELECT语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95"><span class="toc-number">3.2.2.1.</span> <span class="toc-text">语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#INSERT-INTO%E8%AF%AD%E5%8F%A5"><span class="toc-number">3.2.3.</span> <span class="toc-text">INSERT INTO语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95-1"><span class="toc-number">3.2.3.1.</span> <span class="toc-text">语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UPDATE%E8%AF%AD%E5%8F%A5"><span class="toc-number">3.2.4.</span> <span class="toc-text">UPDATE语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95-2"><span class="toc-number">3.2.4.1.</span> <span class="toc-text">语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DELETE%E8%AF%AD%E5%8F%A5"><span class="toc-number">3.2.5.</span> <span class="toc-text">DELETE语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95-3"><span class="toc-number">3.2.5.1.</span> <span class="toc-text">语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WHERE%E5%AD%90%E5%8F%A5"><span class="toc-number">3.2.6.</span> <span class="toc-text">WHERE子句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#and-x2F-or%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">3.2.6.1.</span> <span class="toc-text">and&#x2F;or运算符</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#order-BY-%E5%AD%97%E5%8F%A5"><span class="toc-number">3.2.7.</span> <span class="toc-text">order BY 字句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E9%87%8D%E6%8E%92%E5%BA%8F"><span class="toc-number">3.2.7.1.</span> <span class="toc-text">多重排序</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#COUNT-%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.8.</span> <span class="toc-text">COUNT(*)函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AS%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">3.2.9.</span> <span class="toc-text">AS关键字</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E6%A8%A1%E5%9D%97"><span class="toc-number">3.3.</span> <span class="toc-text">mysql模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E7%AC%AC%E4%B8%89%E6%96%B9%E6%A8%A1%E5%9D%97mysql"><span class="toc-number">3.3.1.</span> <span class="toc-text">安装第三方模块mysql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEmysql%E6%A8%A1%E5%9D%97"><span class="toc-number">3.3.2.</span> <span class="toc-text">配置mysql模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87mysql%E6%A8%A1%E5%9D%97%E6%89%A7%E8%A1%8CSQL%E8%AF%AD%E5%8F%A5"><span class="toc-number">3.3.3.</span> <span class="toc-text">通过mysql模块执行SQL语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE"><span class="toc-number">3.3.3.1.</span> <span class="toc-text">查询数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">3.3.3.2.</span> <span class="toc-text">插入数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE"><span class="toc-number">3.3.3.3.</span> <span class="toc-text">更新数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">3.3.3.4.</span> <span class="toc-text">删除数据</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%87%E8%AE%B0%E5%88%A0%E9%99%A4"><span class="toc-number">3.3.3.4.1.</span> <span class="toc-text">标记删除</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E5%90%8E%E7%AB%AF%E7%9A%84%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81"><span class="toc-number">4.</span> <span class="toc-text">前后端的身份认证</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB%E5%BC%80%E5%8F%91%E6%A8%A1%E5%BC%8F"><span class="toc-number">4.1.</span> <span class="toc-text">WEB开发模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%B8%B2%E6%9F%93%E7%9A%84%E4%BC%A0%E7%BB%9F%E5%BC%80%E5%8F%91%E6%A8%A1%E5%BC%8F"><span class="toc-number">4.1.1.</span> <span class="toc-text">基于服务端渲染的传统开发模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E7%9A%84%E6%96%B0%E5%9E%8B%E5%BC%80%E5%8F%91%E6%A8%A1%E5%BC%8F"><span class="toc-number">4.1.2.</span> <span class="toc-text">基于前后端分离的新型开发模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9%E5%BC%80%E5%8F%91%E6%A8%A1%E5%BC%8F"><span class="toc-number">4.1.3.</span> <span class="toc-text">如何选择开发模式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81"><span class="toc-number">4.2.</span> <span class="toc-text">身份认证</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%90%8C%E5%BC%80%E5%8F%91%E6%A8%A1%E5%BC%8F%E4%B8%8B%E7%9A%84%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81"><span class="toc-number">4.2.1.</span> <span class="toc-text">不同开发模式下的身份认证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Session%E8%AE%A4%E8%AF%81%E6%9C%BA%E5%88%B6"><span class="toc-number">4.2.2.</span> <span class="toc-text">Session认证机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP%E5%8D%8F%E8%AE%AE%E7%9A%84%E6%97%A0%E7%8A%B6%E6%80%81%E6%80%A7"><span class="toc-number">4.2.2.1.</span> <span class="toc-text">HTTP协议的无状态性</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#cookie"><span class="toc-number">4.2.2.1.1.</span> <span class="toc-text">cookie</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">4.2.2.2.</span> <span class="toc-text">工作原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#express%E4%B8%AD%E4%BD%BF%E7%94%A8session"><span class="toc-number">4.2.2.3.</span> <span class="toc-text">express中使用session</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JWT%E8%AE%A4%E8%AF%81%E6%9C%BA%E5%88%B6"><span class="toc-number">4.2.3.</span> <span class="toc-text">JWT认证机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8express%E4%B8%AD%E4%BD%BF%E7%94%A8JWT"><span class="toc-number">4.2.3.1.</span> <span class="toc-text">在express中使用JWT</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E6%A8%A1%E5%9D%97"><span class="toc-number">4.2.3.1.1.</span> <span class="toc-text">导入模块</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89secret%E5%AF%86%E9%92%A5"><span class="toc-number">4.2.3.1.2.</span> <span class="toc-text">定义secret密钥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%94%9F%E6%88%90JWT%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">4.2.3.1.3.</span> <span class="toc-text">生成JWT字符串</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%98%E5%8E%9Fjson%E5%AF%B9%E8%B1%A1"><span class="toc-number">4.2.3.1.4.</span> <span class="toc-text">还原json对象</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF"><span class="toc-number">4.2.3.1.5.</span> <span class="toc-text">获取用户信息</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8D%95%E8%8E%B7%E8%A7%A3%E6%9E%90JWT%E5%A4%B1%E8%B4%A5%E5%90%8E%E7%9A%84%E9%94%99%E8%AF%AF"><span class="toc-number">4.2.3.1.6.</span> <span class="toc-text">捕获解析JWT失败后的错误</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/03/15/Node/" title="Node"><img src="/./img/node.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Node"/></a><div class="content"><a class="title" href="/2023/03/15/Node/" title="Node">Node</a><time datetime="2023-03-15T13:16:58.000Z" title="发表于 2023-03-15 21:16:58">2023-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/09/%E5%9B%9E%E6%BA%AF%E7%AE%97%E6%B3%95/" title="回溯算法"><img src="https://www.dmoe.cc/random.php" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="回溯算法"/></a><div class="content"><a class="title" href="/2023/02/09/%E5%9B%9E%E6%BA%AF%E7%AE%97%E6%B3%95/" title="回溯算法">回溯算法</a><time datetime="2023-02-09T14:01:22.000Z" title="发表于 2023-02-09 22:01:22">2023-02-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/25/Typescript/" title="Typescript"><img src="/./img/th.jfif" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Typescript"/></a><div class="content"><a class="title" href="/2023/01/25/Typescript/" title="Typescript">Typescript</a><time datetime="2023-01-25T12:01:34.000Z" title="发表于 2023-01-25 20:01:34">2023-01-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Lx</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/algoliasearch-lite.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo-myblog.coderlx.cn/',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-myblog.coderlx.cn/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><div class="aplayer no-destroy" data-id="000PeZCQ1i4XVs" data-server="tencent" data-type="artist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><script defer src="/js/light.js"></script><script async src="https://npm.elemecdn.com/tzy-blog/lib/js/other/sakura.js"></script><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/rightMenu.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script>window.$crisp = [];
window.CRISP_WEBSITE_ID = "ea1d2e27-23c8-4175-99bb-e012c9e96698";
(function () {
  d = document;
  s = d.createElement("script");
  s.src = "https://client.crisp.chat/l.js";
  s.async = 1;
  d.getElementsByTagName("head")[0].appendChild(s);
})();
$crisp.push(["safe", true])

if (true) {
  $crisp.push(["do", "chat:hide"])
  $crisp.push(["on", "chat:closed", function() {
    $crisp.push(["do", "chat:hide"])
  }])
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      $crisp.push(["do", "chat:show"])
      $crisp.push(["do", "chat:open"])

    });
  }
  chatBtnFn()
} else {
  if (false) {
    function chatBtnHide () {
      $crisp.push(["do", "chat:hide"])
    }
    function chatBtnShow () {
      $crisp.push(["do", "chat:show"])
    }
  }
}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(https://api.ddkjt.com/api/img_1.php);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/刷题记录/&quot;);" href="javascript:void(0);">刷题记录</a><span class="categoryBar-list-count">7</span><span class="categoryBar-list-descr">记录</span></li><li class="categoryBar-list-item" style="background:url(undefined);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/Node/&quot;);" href="javascript:void(0);">Node</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(undefined);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/学习笔记/&quot;);" href="javascript:void(0);">学习笔记</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr"></span></li><li class="categoryBar-list-item" style="background:url(undefined);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/Node/学习笔记/&quot;);" href="javascript:void(0);">学习笔记</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr"></span></li></ul></div></div>';
      console.log('已挂载butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var qweather_key = '58da29ac87ae4aba8c409c566e707257';
  var gaud_map_key = '55af2c15427825c15941055e09fc0be1';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '113.34532,23.15624';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/03/15/Node/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="./img/node.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-03-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/03/15/Node/&quot;);" href="javascript:void(0);" alt="">Node</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/03/15/Node/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/02/09/回溯算法/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://www.dmoe.cc/random.php" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-02-09</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/02/09/回溯算法/&quot;);" href="javascript:void(0);" alt="">回溯算法</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/02/09/回溯算法/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/01/25/Typescript/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="./img/th.jfif" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-25</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/01/25/Typescript/&quot;);" href="javascript:void(0);" alt="">Typescript</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/01/25/Typescript/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/01/16/2023.01.16树/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://www.dmoe.cc/random.php" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-16</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/01/16/2023.01.16树/&quot;);" href="javascript:void(0);" alt="">二叉树</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/01/16/2023.01.16树/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/01/14/2023.01.13栈与队列/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://api.dujin.org/bing/1920.php" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-14</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/01/14/2023.01.13栈与队列/&quot;);" href="javascript:void(0);" alt="">栈与队列</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/01/14/2023.01.13栈与队列/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/01/14/2023.01.13字符串/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://www.dmoe.cc/random.php" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-14</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/01/14/2023.01.13字符串/&quot;);" href="javascript:void(0);" alt="">字符串</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/01/14/2023.01.13字符串/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/01/14/2023.01.13哈希表/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://api.ucany.net/acg-pc.php" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-14</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/01/14/2023.01.13哈希表/&quot;);" href="javascript:void(0);" alt="">哈希表</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/01/14/2023.01.13哈希表/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2023/01/14/2023.01.13链表/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://api.paugram.com/wallpaper/" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-14</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2023/01/14/2023.01.13链表/&quot;);" href="javascript:void(0);" alt="">链表</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2023/01/14/2023.01.13链表/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/12/19/2023.01.13数组/&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src="https://api.ddkjt.com/api/img_1.php" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2022-12-19</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/12/19/2023.01.13数组/&quot;);" href="javascript:void(0);" alt="">数组</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/12/19/2023.01.13数组/&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '1s');
    arr[i].setAttribute('data-wow-offset', '100');
    arr[i].setAttribute('data-wow-iteration', '2');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '');
    arr[i].setAttribute('data-wow-delay', '');
    arr[i].setAttribute('data-wow-offset', '');
    arr[i].setAttribute('data-wow-iteration', '');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v6.2.0" title=""><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.3.1" title=""><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="https://npm.elemecdn.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.js"></script><!-- hexo injector body_end end --></body></html>